var L=Object.defineProperty,S=Object.defineProperties;var M=Object.getOwnPropertyDescriptors;var g=Object.getOwnPropertySymbols;var $=Object.prototype.hasOwnProperty,R=Object.prototype.propertyIsEnumerable;var y=(e,l,t)=>l in e?L(e,l,{enumerable:!0,configurable:!0,writable:!0,value:t}):e[l]=t,F=(e,l)=>{for(var t in l||(l={}))$.call(l,t)&&y(e,t,l[t]);if(g)for(var t of g(l))R.call(l,t)&&y(e,t,l[t]);return e},v=(e,l)=>S(e,M(l));var _=(e,l,t)=>new Promise((a,m)=>{var u=c=>{try{i(t.next(c))}catch(r){m(r)}},b=c=>{try{i(t.throw(c))}catch(r){m(r)}},i=c=>c.done?a(c.value):Promise.resolve(c.value).then(u,b);i((t=t.apply(e,l)).next())});import{j as s,L as q}from"./main.js";import{h as V,B as D,_ as p,E as P}from"./bi-490-178.js";import{h as k,a as w,d as T}from"./bi-200-835.js";import{g as E,a as z,b as I}from"./bi-584-857.js";import{S as A}from"./bi-652-725.js";import{T as B}from"./bi-528-726.js";import{h as G}from"./bi-266-720.js";function O({i:e,field:l,formFields:t,notionConf:a,setNotionConf:m}){var r,h,x,N;const u=V(D),{isPro:b}=u;if(((r=a==null?void 0:a.field_map)==null?void 0:r.length)===1&&l.notionFormFields===""){const d=F({},a),j=E(d);d.field_map=j,m(d)}const i=((h=a==null?void 0:a.notionFields)==null?void 0:h.filter(d=>d.required===!0))||[],c=((x=a==null?void 0:a.notionFields)==null?void 0:x.filter(d=>d.required===!1))||[];return s.jsx("div",{className:"flx mt-2 mb-2 btcbi-field-map",children:s.jsxs("div",{className:"pos-rel flx",children:[s.jsxs("div",{className:"flx integ-fld-wrp",children:[s.jsxs("select",{className:"btcd-paper-inp mr-2",name:"formFields",onChange:d=>{k(d,e,a,m)},value:l.formFields||"",children:[s.jsx("option",{value:"",children:p("Select Field")}),s.jsx("optgroup",{label:"Form Fields",children:t==null?void 0:t.map(d=>s.jsx("option",{value:d.name,children:d.label},`ff-rm-${d.name}`))}),s.jsx("option",{value:"custom",children:p("Custom...")}),s.jsx("optgroup",{label:`General Smart Codes ${b?"":"(PRO)"}`,children:b&&((N=A)==null?void 0:N.map(d=>s.jsx("option",{value:d.name,children:d.label},`ff-rm-${d.name}`)))})]}),l.formField==="custom"&&s.jsx(B,{onChange:d=>G(d,e,a,m),label:p("Custom Value","bit-integrations"),className:"mr-2",type:"text",value:l.customValue,placeholder:p("Custom Value","bit-integrations"),formFields:t}),s.jsxs("select",{className:"btcd-paper-inp",disabled:e<i.length,name:"notionFormFields",onChange:d=>{k(d,e,a,m)},value:e<i.length?i[e].label||"":l.notionFormFields||"",children:[s.jsx("option",{value:"",children:p("Select Field")}),e<i.length?s.jsx("option",{value:i[e].label,children:i[e].label},i[e].key):c.map(({key:d,label:j})=>s.jsx("option",{value:j,children:j},j))]})]}),s.jsx("button",{onClick:()=>w(e,a,m),className:"icn-btn sh-sm ml-2 mr-1",type:"button",children:"+"}),s.jsx("button",{onClick:()=>T(e,a,m),className:"icn-btn sh-sm ml-1",type:"button","aria-label":"btn",children:s.jsx("span",{className:"btcd-icn icn-trash-2"})})]})})}function Z({notionConf:e,setNotionConf:l,formFields:t,loading:a,setLoading:m}){var b,i;const u=c=>_(this,null,function*(){const r=F({},e),{name:h,value:x}=c.target;switch(x!==""?r[h]=x:delete r[h],h){case"databaseId":r.databaseId===""&&(r.field_map=[{formFields:"",notionFormFields:""}]),r.databaseId&&(m(v(F({},a),{field:!0})),r.notionFields=yield I(r,l),r.notionFields&&m(v(F({},a),{field:!1})));break}l(r)});return s.jsxs("div",{className:"mt-2",children:[!a.page&&((b=e==null?void 0:e.default)==null?void 0:b.databaseLists)&&s.jsxs("div",{className:"flx mt-2",children:[s.jsx("b",{className:"wdt-200 d-in-b ",children:p("Database List:")}),s.jsxs("select",{onChange:u,name:"databaseId",value:e==null?void 0:e.databaseId,className:"btcd-paper-inp w-5 mx-0",children:[s.jsx("option",{value:"",children:p("Select Database")}),((i=e==null?void 0:e.default)==null?void 0:i.databaseLists)&&(e==null?void 0:e.default.databaseLists.map(c=>s.jsx("option",{value:c.id,children:c.name},c.id)))]}),s.jsx("button",{onClick:()=>z(e,l,a,m),className:"icn-btn sh-sm ml-2 mr-2 tooltip",style:{"--tooltip-txt":'"Refresh list"'},type:"button",disabled:a.list,children:"↻"}),a.list&&s.jsx(P,{size:"20",clr:"#022217",className:"ml-2"})]}),(e==null?void 0:e.databaseId)&&s.jsxs("div",{className:"mt-5",children:[s.jsx("b",{className:"wdt-100",children:p("Field Map")}),s.jsx("button",{onClick:()=>I(e,l,a,m),className:"icn-btn sh-sm ml-2 mr-2 tooltip",style:{"--tooltip-txt":`'${p("Refresh custom fields","bit-integrations")}'`},type:"button",disabled:a.field,children:"↻"}),s.jsx("div",{className:"btcd-hr mt-2 mb-4"}),s.jsxs("div",{className:"flx flx-around mt-2 mb-2 btcbi-field-map-label",children:[s.jsx("div",{className:"txt-dp",children:s.jsx("b",{children:p("Form Fields")})}),s.jsx("div",{className:"txt-dp",children:s.jsx("b",{children:p("Notion Fields")})})]}),e==null?void 0:e.field_map.map((c,r)=>s.jsx(O,{i:r,field:c,formFields:t,notionConf:e,setNotionConf:l},`ko-m-${r+8}`)),s.jsx("div",{className:"txt-center btcbi-field-map-button mt-2",children:s.jsx("button",{onClick:()=>w(e.field_map.length,e,l),className:"icn-btn sh-sm",type:"button",children:"+"})})]}),(a.page||a.field)&&s.jsx(q,{style:{display:"flex",justifyContent:"center",alignItems:"center",height:100,transform:"scale(0.7)"}})]})}export{Z as N};
