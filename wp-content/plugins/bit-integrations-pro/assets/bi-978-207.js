var T=Object.defineProperty;var j=Object.getOwnPropertySymbols;var $=Object.prototype.hasOwnProperty,q=Object.prototype.propertyIsEnumerable;var v=(n,o,s)=>o in n?T(n,o,{enumerable:!0,configurable:!0,writable:!0,value:s}):n[o]=s,m=(n,o)=>{for(var s in o||(o={}))$.call(o,s)&&v(n,s,o[s]);if(j)for(var s of j(o))q.call(o,s)&&v(n,s,o[s]);return n};import{r as h,j as t}from"./main.js";import{e as A,f as B,R as w,$ as D,h as H,i as W,g as z,b as G,c as O,_ as c,a7 as J,ad as k,E as K}from"./bi-490-178.js";import{c as y,s as Q}from"./bi-266-720.js";import{u as F,U as V,C as X,c as Y}from"./bi-421-779.js";import{E as Z,a as ee}from"./bi-389-719.js";import{C as te}from"./bi-369-724.js";import{C}from"./bi-579-738.js";import"./bi-422-718.js";import"./bi-652-725.js";import"./bi-528-726.js";function he({allIntegURL:n}){var b,_;const o=A(),{formID:s}=B(),[U,d]=h.useState({show:!1}),[E,I]=h.useState([]),[f,N]=h.useState(!1),[p,R]=w(D),g=H(W),[e,u]=w(z);h.useEffect(()=>{var l,r;const a=m({},e);G({},"role/list",null,"GET").then(i=>{i!=null&&i.success&&i!==void 0&&I(Object.values(i==null?void 0:i.data))}),(r=(l=a==null?void 0:a.user_map)==null?void 0:l[0])!=null&&r.userField||(a.user_map=F.filter(i=>i.required).map(i=>({formField:"",userField:i.key,required:i.required}))),u(a)},[]);const S=()=>{if(!e.action_type){d({show:!0,msg:c("Please select action type","bit-integrations")});return}if(!e.user_role&&e.action_type!=="updated_user"){d({show:!0,msg:c("User Role can't be empty","bit-integrations")});return}if(!Y(e)&&e.action_type!=="updated_user"){d({show:!0,msg:c("Please map mandatory fields","bit-integrations")});return}Q({flow:p,setFlow:R,allIntegURL:n,conf:e,history:o,edit:1,setIsLoading:N,setSnackbar:d})},L=(a,l)=>{const r=m({},e);l?r.condition.action_behavior=a:r.condition.action_behavior="",u(r)},x=a=>{const l=m({},e),{name:r,value:i}=a.target;a.target.checked&&(l[r]=i),u(m({},l))},M=`
  <ul>
  <li>The user must be logged in when updating profile</li>
  <li>The user cannot change the value of the username field when updating the user profile.</li>
     
  </ul>`,P=`
  <ul>
  <li>If the Username and Password fields are blank then the user will take the value of the email field as the field and the password will be auto-generated.</li>
     
  </ul>`;return t.jsxs("div",{children:[t.jsx(O,{snack:U,setSnackbar:d}),t.jsx("br",{}),!y(p.triggered_entity)&&t.jsx(Z,{setSnackbar:d}),y(p.triggered_entity)&&t.jsx(ee,{setSnackbar:d}),t.jsx("div",{className:"font-w-m mt-3",children:c("Action type","bit-integrations")}),t.jsxs("div",{children:[t.jsx(C,{radio:!0,name:"action_type",onChange:x,checked:(e==null?void 0:e.action_type)==="new_user",value:"new_user",title:c("New User Create","bit-integrations")}),t.jsx(C,{radio:!0,name:"action_type",onChange:x,checked:(e==null?void 0:e.action_type)==="updated_user",value:"updated_user",title:c("Updated User","bit-integrations")})]}),t.jsx("div",{children:t.jsx(V,{formFields:g,formID:s,userConf:e,setUserConf:u,roles:E,userFields:F})}),t.jsxs("div",{children:[t.jsx(X,{formFields:g,formID:s,userConf:e,setUserConf:u}),t.jsx("br",{})]}),(e==null?void 0:e.condition)&&t.jsxs(t.Fragment,{children:[t.jsx("div",{className:"flx",children:t.jsx(J,{onChange:a=>L(a.target.value,a.target.checked),checked:((b=e==null?void 0:e.condition)==null?void 0:b.action_behavior)==="cond",className:"wdt-200 mt-4 mr-2",value:"cond",title:c("Conditional Logics","bit_integration")})}),t.jsx("br",{}),((_=e==null?void 0:e.condition)==null?void 0:_.action_behavior)==="cond"&&t.jsx(te,{formFields:g,dataConf:e,setDataConf:u})]}),(e==null?void 0:e.action_type)==="updated_user"?t.jsx(k,{note:M}):t.jsx(k,{note:P}),t.jsxs("button",{className:"btn f-left btcd-btn-lg green sh-sm flx",type:"button",onClick:S,disabled:f,children:[c("Update","bit-integrations"),f&&t.jsx(K,{size:20,clr:"#022217",className:"ml-2"})]})]})}export{he as default};
