var A=Object.defineProperty;var v=Object.getOwnPropertySymbols;var G=Object.prototype.hasOwnProperty,I=Object.prototype.propertyIsEnumerable;var N=(s,c,e)=>c in s?A(s,c,{enumerable:!0,configurable:!0,writable:!0,value:e}):s[c]=e,u=(s,c)=>{for(var e in c||(c={}))G.call(c,e)&&N(s,e,c[e]);if(v)for(var e of v(c))I.call(c,e)&&N(s,e,c[e]);return s};import{r as j,j as t,L as k}from"./main.js";import{a7 as F,_ as n,d as q,a8 as T,h as $,B as O}from"./bi-490-178.js";import{g as w,a as V,m as M}from"./bi-566-853.js";import{S as E}from"./bi-652-725.js";import{h as z}from"./bi-266-720.js";import{T as B}from"./bi-528-726.js";function P({mailRelayConf:s,setMailRelayConf:c,loading:e,setLoading:i}){var x,p;const[a,o]=j.useState({show:!1,action:()=>{}}),b=(d,l)=>{var h;const r=u({},s);l==="group"&&((h=d.target)!=null&&h.checked?(w(s,c,i),r.actions.groups=!0):(o({show:!1}),delete r.actions.groups),o({show:"group"})),l==="update"&&(d.target.checked?r.actions.update=!0:delete r.actions.update),l==="doubleOptIn"&&(d.target.checked?r.actions.doubleOptIn=!0:delete r.actions.doubleOptIn),c(u({},r))},g=()=>{o({show:!1})},m=d=>{const l=u({},s);l.selectedGroups=d,c(u({},l))};return t.jsxs("div",{className:"pos-rel d-flx w-8",children:[t.jsx(F,{checked:(s==null?void 0:s.selectedGroups.length)||!1,onChange:d=>b(d,"group"),className:"wdt-200 mt-4 mr-2",value:"group",title:n("Add Groups","bit - integrations"),subTitle:n("Add Groups")}),t.jsx(F,{checked:((x=s.actions)==null?void 0:x.update)||!1,onChange:d=>b(d,"update"),className:"wdt-200 mt-4 mr-2",value:"update_subscriber",title:n("Update subscriber","bit-integrations"),subTitle:n("Override the existing subscriber info by responses.","bit-integrations")}),t.jsxs(q,{className:"custom-conf-mdl",mainMdlCls:"o-v",btnClass:"blue",btnTxt:n("Ok","bit-integrations"),show:a.show==="group",close:g,action:g,title:n("Groups","bit-integrations"),children:[t.jsx("div",{className:"btcd-hr mt-2 mb-2"}),t.jsx("div",{className:"mt-2",children:n("Select groups","bit-integrations")}),e.groups?t.jsx(k,{style:{display:"flex",justifyContent:"center",alignItems:"center",height:45,transform:"scale(0.5)"}}):t.jsxs("div",{className:"flx flx-between mt-2",children:[t.jsx(T,{options:(p=s==null?void 0:s.groups)==null?void 0:p.map(d=>({label:d.name,value:d.id})),className:"msl-wrp-options",defaultValue:s==null?void 0:s.selectedGroups,onChange:d=>m(d)}),t.jsx("button",{onClick:()=>w(s,c,i),className:"icn-btn sh-sm ml-2 mr-2 tooltip",style:{"--tooltip-txt":`${n("Refresh Groups","bit-integrations")}'`},type:"button",children:"↻"})]})]})]})}const S=(s,c,e)=>{const i=u({},c);i.field_map.splice(s,0,{}),e(u({},i))},H=(s,c,e)=>{const i=u({},c);i.field_map.length>1&&i.field_map.splice(s,1),e(u({},i))},_=(s,c,e,i)=>{const a=u({},e);a.field_map[c][s.target.name]=s.target.value,s.target.value==="custom"&&(a.field_map[c].customValue=""),i(u({},a))};function L({i:s,formFields:c,field:e,mailRelayConf:i,setMailRelayConf:a}){var d,l;const o=(i==null?void 0:i.staticFields.filter(r=>r.required===!0))||[],b=(i==null?void 0:i.customFields.filter(r=>r.required===!1))||[],m=[...(i==null?void 0:i.staticFields.filter(r=>r.required===!1))||[],...b];if(((d=i==null?void 0:i.field_map)==null?void 0:d.length)===1&&e.mailRelayFormField===""){const r=u({},i),h=V(r);r.field_map=h,a(r)}const x=$(O),{isPro:p}=x;return t.jsx("div",{className:"flx mt-2 mb-2 btcbi-field-map",children:t.jsxs("div",{className:"pos-rel flx",children:[t.jsxs("div",{className:"flx integ-fld-wrp",children:[t.jsxs("select",{className:"btcd-paper-inp mr-2",name:"formField",value:e.formField||"",onChange:r=>_(r,s,i,a),children:[t.jsx("option",{value:"",children:n("Select Field","bit-integrations")}),t.jsx("optgroup",{label:"Form Fields",children:c==null?void 0:c.map(r=>t.jsx("option",{value:r.name,children:r.label},`ff-rm-${r.name}`))}),t.jsx("option",{value:"custom",children:n("Custom...","bit-integrations")}),t.jsx("optgroup",{label:`General Smart Codes ${p?"":"(PRO)"}`,children:p&&((l=E)==null?void 0:l.map(r=>t.jsx("option",{value:r.name,children:r.label},`ff-rm-${r.name}`)))})]}),e.formField==="custom"&&t.jsx(B,{onChange:r=>z(r,s,i,a),label:n("Custom Value","bit-integrations"),className:"mr-2",type:"text",value:e.customValue,placeholder:n("Custom Value","bit-integrations"),formFields:c}),t.jsxs("select",{className:"btcd-paper-inp",disabled:s<o.length,name:"mailRelayFormField",value:s<o?o[s].label||"":e.mailRelayFormField||"",onChange:r=>_(r,s,i,a),children:[t.jsx("option",{value:"",children:n("Select Field","bit-integrations")}),s<o.length?t.jsx("option",{value:o[s].key,children:o[s].label},o[s].key):m.map(({key:r,label:h})=>t.jsx("option",{value:r,children:h},r))]})]}),s>=o.length&&t.jsxs(t.Fragment,{children:[t.jsx("button",{onClick:()=>S(s,i,a),className:"icn-btn sh-sm ml-2 mr-1",type:"button",children:"+"}),t.jsx("button",{onClick:()=>H(s,i,a),className:"icn-btn sh-sm ml-1",type:"button","aria-label":"btn",children:t.jsx("span",{className:"btcd-icn icn-trash-2"})})]})]})})}function Y({formFields:s,handleInput:c,mailRelayConf:e,setMailRelayConf:i,loading:a,setLoading:o,setSnackbar:b}){const[g,m]=j.useState({name:"",auth_token:""}),[x,p]=j.useState(!1);return t.jsxs(t.Fragment,{children:[t.jsx("br",{}),t.jsx("b",{className:"wdt-200 d-in-b",children:n("Subscriber Status:","bit-integrations")}),t.jsxs("select",{onChange:c,name:"status",value:e.status,className:"btcd-paper-inp w-5",children:[t.jsx("option",{value:"",children:n("Select subscriber status","bit-integrations")}),t.jsx("option",{value:"active",children:n("Active","bit-integrations")}),t.jsx("option",{value:"inactive",children:n("Inactive","bit-integrations")})]}),a.customFields&&t.jsx(k,{style:{display:"flex",justifyContent:"center",alignItems:"center",height:100,transform:"scale(0.7)"}}),e.status&&t.jsxs("div",{children:[t.jsx("br",{}),t.jsx("div",{className:"mt-5",children:t.jsxs("b",{className:"wdt-100",children:[n("Field Map","bit-integrations"),t.jsx("button",{onClick:()=>M(e,i,m,p,a,o,"refreshCustomFields"),className:"icn-btn sh-sm ml-2 mr-2 tooltip",style:{"--tooltip-txt":`'${n("Refresh custom fields","bit-integrations")}'`},type:"button",disabled:a.customFields,children:"↻"})]})}),t.jsx("br",{}),t.jsx("div",{className:"btcd-hr mt-1"}),t.jsxs("div",{className:"flx flx-around mt-2 mb-2 btcbi-field-map-label",children:[t.jsx("div",{className:"txt-dp",children:t.jsx("b",{children:n("Form Fields","bit-integrations")})}),t.jsx("div",{className:"txt-dp",children:t.jsx("b",{children:n("MailRelay Fields","bit-integrations")})})]}),e==null?void 0:e.field_map.map((d,l)=>t.jsx(L,{i:l,field:d,mailRelayConf:e,formFields:s,setMailRelayConf:i,setSnackbar:b},`rp-m-${l+9}`)),t.jsx("div",{className:"txt-center btcbi-field-map-button mt-2",children:t.jsx("button",{onClick:()=>S(e.field_map.length,e,i),className:"icn-btn sh-sm",type:"button",children:"+"})}),t.jsx("br",{}),t.jsx("br",{}),t.jsx("div",{className:"mt-4",children:t.jsx("b",{className:"wdt-100",children:n("Actions","bit-integrations")})}),t.jsx("div",{className:"btcd-hr mt-1"}),t.jsx(P,{mailRelayConf:e,setMailRelayConf:i,formFields:s,loading:a,setLoading:o})]})]})}export{Y as M};
