var m=Object.defineProperty;var b=Object.getOwnPropertySymbols;var I=Object.prototype.hasOwnProperty,_=Object.prototype.propertyIsEnumerable;var f=(e,a,t)=>a in e?m(e,a,{enumerable:!0,configurable:!0,writable:!0,value:t}):e[a]=t,s=(e,a)=>{for(var t in a||(a={}))I.call(a,t)&&f(e,t,a[t]);if(b)for(var t of b(a))_.call(a,t)&&f(e,t,a[t]);return e};import{_ as n,a as u,b as $}from"./bi-490-178.js";const y=(e,a,t)=>{const i=s({},a),{name:c}=e.target;e.target.value!==""?i[c]=e.target.value:delete i[c],t(s({},i))},k=e=>!((e?e.filter(t=>!t.formField||!t.googleContactsFormField):[]).length>0),v=(e,a,t,i,c)=>{if(!e.clientId||!e.clientSecret){c({clientId:e.clientId?"":n("Client Id can't be empty","bit-integrations"),clientSecret:e.clientSecret?"":n("Client Secret can't be empty","bit-integrations")});return}i(!0);const o=`https://accounts.google.com/o/oauth2/v2/auth?scope=https://www.googleapis.com/auth/contacts&access_type=offline&prompt=consent&response_type=code&state=${encodeURIComponent(window.location.href)}/redirect&redirect_uri=${encodeURIComponent(`${btcbi.api.base}/redirect`)}&client_id=${e.clientId}`,d=window.open(o,"googleContacts","width=400,height=609,toolbar=off"),F=setInterval(()=>{if(d.closed){clearInterval(F);let r={},p=!1;const h=localStorage.getItem("__googleContacts");if(h&&(p=!0,r=JSON.parse(h),localStorage.removeItem("__googleContacts")),!r.code||r.error||!r||!p){const g=r.error?`Cause: ${r.error}`:"";u.error(`${n("Authorization failed","bit-integrations")} ${g}. ${n("please try again","bit-integrations")}`),i(!1)}else{const g=s({},e);g.accountServer=r["accounts-server"],w(r,g,a,t,i)}}},500)},w=(e,a,t,i,c)=>{const l=s({},e);l.clientId=a.clientId,l.clientSecret=a.clientSecret,l.redirectURI=`${btcbi.api.base}/redirect`,$(l,"googleContacts_authorization").then(o=>{if(o&&o.success){const d=s({},a);d.tokenDetails=o.data,t(d),i(!0),u.success(n("Authorized Successfully","bit-integrations"))}else o&&o.data&&o.data.data||!o.success&&typeof o.data=="string"?u.error(`${n("Authorization failed Cause:","bit-integrations")}${o.data.data||o.data}. ${n("please try again","bit-integrations")}`):u.error(n("Authorization failed. please try again","bit-integrations"));c(!1)})},R=e=>{const a=e==null?void 0:e.default.filter(t=>t.required===!0);return a.length>0?a.map(t=>({formField:"",googleContactsFormField:t.key})):[{formField:"",googleContactsFormField:""}]};export{v as a,k as c,R as g,y as h};
