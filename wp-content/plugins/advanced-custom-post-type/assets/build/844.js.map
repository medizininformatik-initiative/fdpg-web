{"version":3,"file":"844.js","mappings":";;;;;;;;;;;;;;AAAA;;;;AACA;;;;AACA;;;;AACA;;;;AACA;;AACA;;AACA;;;;AACA;;AACA;;AACA;;AACA;;;;AACA;;AACA;;AACA;;AACA;;AACA;;AACA;;;;AACA;;;;AACA;;AACA;;;;;;AAEA,IAAMA,iBAAiB,SAAjBA,cAAiB,GAAM;;AAEzB;AAFyB,qBAGJ,gCAHI;AAAA,QAGjBC,QAHiB,cAGjBA,QAHiB;;AAIzB,QAAMC,WAAW,8BAAjB;;AAJyB,uBAKoF,6BAAY;AAAA,eAASC,MAAMC,gBAAf;AAAA,KAAZ,CALpF;AAAA,QAKlBC,KALkB,gBAKlBA,KALkB;AAAA,QAKXC,MALW,gBAKXA,MALW;AAAA,QAKHC,MALG,gBAKHA,MALG;AAAA,QAKKC,MALL,gBAKKA,MALL;AAAA,QAKaC,OALb,gBAKaA,OALb;AAAA,QAKsBC,OALtB,gBAKsBA,OALtB;AAAA,QAKwCC,WALxC,gBAK+BC,OAL/B;AAAA,QAK6DC,UAL7D,gBAKqDC,MALrD;AAAA,QAKyEC,OALzE,gBAKyEA,OALzE;;AAAA,wBAMiC,6BAAY;AAAA,eAASZ,MAAMa,sBAAf;AAAA,KAAZ,CANjC;AAAA,QAMTC,gBANS,iBAMlBL,OANkB;AAAA,QAMkBM,WANlB,iBAMSC,OANT;;AAAA,wBAOE,6BAAY;AAAA,eAAShB,MAAMiB,gBAAf;AAAA,KAAZ,CAPF;AAAA,QAOlBR,OAPkB,iBAOlBA,OAPkB;AAAA,QAOTO,OAPS,iBAOTA,OAPS;;AASzB;;;AACA,QAAME,cAAc,mBAAO,KAAP,CAApB;;AAVyB,gCAWe,yCAXf;AAAA;AAAA,QAWlBC,MAXkB;AAAA,QAWVC,QAXU;AAAA,QAWAC,WAXA;;AAAA,oBAYe,qBAAS,KAAT,CAZf;AAAA;AAAA,QAYlBC,YAZkB;AAAA,QAYJC,eAZI;;AAczB;;;AACA,0BAAU,YAAM;AACZ,kCAAa,8BAAe,mBAAf,CAAb,IAAmDjB,UAAU,EAAV,GAAe,GAAlE;AACA,YAAG,CAACA,OAAJ,EAAY;AAAEc;AAAa;AAC9B,KAHD,EAGG,CAACd,OAAD,CAHH;;AAKA;AACA;AACA,0BAAU,YAAM;AACZP,iBAAS,0BAAUyB,qBAAUC,WAApB,EAAiC3B,QAAjC,CAAT;AACAC,iBAAS,sCAAgBD,QAAhB,CAAT;AACH,KAHD,EAGG,CAACU,WAAD,CAHH;;AAKA;AACA,QAAMkB,YAAY,SAAZA,SAAY,OAA0B;AAAA,YAAxBC,QAAwB,QAAxBA,QAAwB;AAAA,YAAdC,QAAc,QAAdA,QAAc;;AACxC7B,iBAAS,gCAAS,iCAAUG,KAAV,EAAiByB,QAAjB,EAA2BC,QAA3B,CAAT,CAAT;AACH,KAFD;;AAIA;AACA,QAAMC,eAAe,SAAfA,YAAe,GAAM;AACvB9B,iBAAS,4BAAWK,MAAX,CAAT;AACAL,iBAAS,uCAAT;AACAsB;AACH,KAJD;;AAMA,QAAMS,kBAAkB,SAAlBA,eAAkB,GAAM;AAC1B/B,iBAAS,kCAAcyB,qBAAUC,WAAxB,EAAqC3B,QAArC,CAAT;AACAC,iBAAS,uCAAT;AACAsB;AACH,KAJD;;AAMA;AACA,0BAAU,YAAM;AACZ,YAAIH,YAAYa,OAAhB,EAAwB;AACpB,gBAAG,CAACvB,WAAJ,EAAgB;AACZ,oBAAGI,OAAH,EAAW;AACPS;AACAW,yCAAMpB,OAAN,CAAc,8BAAe,qCAAf,CAAd;AACH;;AAED,oBAAGF,WAAWuB,MAAX,GAAoB,CAAvB,EAAyB;AACrBvB,+BAAWwB,GAAX,CAAe,UAACC,KAAD,EAAW;AACtBH,6CAAMG,KAAN,CAAYA,KAAZ;AACH,qBAFD;AAGH;AACJ;AACJ,SAbD,MAaO;AACHjB,wBAAYa,OAAZ,GAAsB,IAAtB;AACH;AACJ,KAjBD,EAiBG,CAACvB,WAAD,CAjBH;;AAmBA,QAAGC,WAAWK,gBAAd,EAA+B;AAC3B,eAAO,yBAAC,iBAAD,OAAP;AACH;;AAED,QAAMsB,qBACF;AAAC,uBAAD,CAAO,QAAP;AAAA;AACI;AAAC,2BAAD;AAAA,cAAO,OAAO,8BAAe,sBAAf,CAAd,EAAsD,SAASd,YAA/D;AACI;AAAA;AAAA;AACK,8CAAe,eAAf;AADL,aADJ;AAII;AAAA;AAAA;AACI;AAAA;AAAA;AACI,8BAAK,GADT;AAEI,mCAAU,2BAFd;AAGI,iCAAS,iBAACe,CAAD,EAAO;AACZA,8BAAEC,cAAF;AACAf,4CAAgB,CAACD,YAAjB;AACAQ;AACH;AAPL;AASK,kDAAe,KAAf;AATL,iBADJ;AAAA;AAaI;AAAA;AAAA;AACI,8BAAK,GADT;AAEI,mCAAU,6BAFd;AAGI,iCAAS,iBAACO,CAAD,EAAO;AACZA,8BAAEC,cAAF;AACAf,4CAAgB,CAACD,YAAjB;AACH;AANL;AAQK,kDAAe,IAAf;AARL;AAbJ;AAJJ,SADJ;AA8BI;AAAA;AAAA;AACI,yBAAS,iBAACe,CAAD,EAAO;AACZA,sBAAEC,cAAF;AACAf,oCAAgB,IAAhB;AACH,iBAJL;AAKI,sBAAK,QALT;AAMI,2BAAU;AANd;AAQK,0CAAe,YAAf;AARL;AA9BJ,KADJ;;AA4CA,QAAMgB,UACF;AAAC,uBAAD,CAAO,QAAP;AAAA;AACI;AAAA;AAAA;AACI,sBAAK,GADT;AAEI,yBAAU,iBAACF,CAAD,EAAO;AACbA,sBAAEC,cAAF;AACAvC,6BAAS,iCAAUyB,qBAAUC,WAApB,EAAiC3B,QAAjC,CAAT;AACH,iBALL;AAMI,2BAAU;AANd;AAQK,0CAAe,cAAf;AARL,SADJ;AAWKI,cAAM+B,MAAN,GAAe,CAAf,GAEO;AAAC,2BAAD,CAAO,QAAP;AAAA;AACI;AAAA;AAAA;AACI,8BAAU,CAAC1B,OADf;AAEI,6BAAS,iBAAC8B,CAAD,EAAO;AACZA,0BAAEC,cAAF;AACAT;AACH,qBALL;AAMI,0BAAK,QANT;AAOI,+BAAU;AAPd;AASK,8CAAe,MAAf;AATL,aADJ;AAYKO;AAZL,SAFP,GAiBO;AAAC,2BAAD,CAAO,QAAP;AAAA;AACKpB,oBAAQiB,MAAR,GAAiB,CAAjB,IAAsBG;AAD3B;AA5BZ,KADJ;;AAoCA,WACI;AAAC,wBAAD;AAAA;AACI,iCAAC,oBAAD;AACI,mBAAUrB,YAAYyB,SAAtB,UAAoC,8BAAe,oBAAf,CADxC;AAEI,qBAASD;AAFb,UADJ;AAKI;AAAA;AAAA,cAAM,WAAU,EAAhB;AACI,qCAAC,qBAAD,IAAa,QAAQ,CACjB;AACIE,2BAAO,8BAAe,cAAf,CADX;AAEIC,0BAAM;AAFV,iBADiB,EAKjB;AACID,2BAAO,8BAAe,oBAAf;AADX,iBALiB,CAArB,GADJ;AAUKtB,kBAVL;AAWI,qCAAC,cAAD;AACI,4BAAUrB,QAAV,UADJ;AAEI,2BAAW0B,qBAAUC,WAFzB;AAGI,sBAAM3B,QAHV;AAII,uBAAOI,KAJX;AAKI,wBAAQC,MALZ;AAMI,wBAAQE,MANZ;AAOI,2BAAWqB,SAPf;AAQI,wBAAQtB;AARZ;AAXJ;AALJ,KADJ;AA8BH,CAnLD;;qBAqLeP;;;;;;;;;;;;;;AC1Mf;;AACA;;;;AAMO,IAAM8C,kBAAkBA,uBAAAA,GAAA,SAAlBA,eAAkB,CAACC,IAAD;AAAA;AAAA,2EAAU,iBAAO7C,QAAP,EAAiB8C,QAAjB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;;AAEjC9C,qCAAS,uDAA0B6C,IAA1B,CAAT;AAFiC;AAAA,mCAGX,yBAAc,uBAAd,EAAuC,EAACA,MAAKA,IAAN,EAAvC,CAHW;;AAAA;AAG3B5B,mCAH2B;;AAIjCjB,qCAAS,oDAAuBiB,OAAvB,CAAT;AAJiC;AAAA;;AAAA;AAAA;AAAA;;AAMjCjB,qCAAS,gEAAT;;AANiC;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,SAAV;;AAAA;AAAA;AAAA;AAAA;AAAA,CAAxB","sources":["webpack://advanced-custom-post-type/./assets/src/App/components/pages/OptionPageMeta/index.js","webpack://advanced-custom-post-type/./assets/src/App/redux/thunks/fetchOptionPage.js"],"sourcesContent":["import React, {useEffect, useRef, useState} from 'react';\nimport Layout from \"../../reusable/Layout\";\nimport ActionsBar from \"../../reusable/Layout/ActionsBar\";\nimport Breadcrumbs from \"../../reusable/Layout/Breadcrumbs\";\nimport {useParams} from \"react-router-dom\";\nimport {useDispatch, useSelector} from \"react-redux\";\nimport useUnsavedChangesWarning from \"../../../hooks/useUnsavedChangesWarning\";\nimport {metaTitle} from \"../../../utils/misc\";\nimport {fetchMeta} from \"../../../redux/thunks/fetchMeta\";\nimport {metaTypes} from \"../../../constants/metaTypes\";\nimport Spinner from \"../../reusable/Loader/Spinner\";\nimport {createBox, setBoxes, setStatusSaved} from \"../../../redux/actions/metaStateActions\";\nimport {arrayMove} from \"react-sortable-hoc\";\nimport {metaSubmit} from \"../../../redux/thunks/metaSubmit\";\nimport {deleteAllMeta} from \"../../../redux/thunks/deleteAllMeta\";\nimport {toast} from \"react-toastify\";\nimport Modal from \"../../reusable/Modal\";\nimport Meta from \"../../reusable/Meta\";\nimport {fetchOptionPage} from \"../../../redux/thunks/fetchOptionPage\";\nimport useTranslation from \"../../../hooks/useTranslation\";\n\nconst OptionPageMeta = () => {\n\n    // manage global state\n    const { menuSlug } = useParams();\n    const dispatch = useDispatch();\n    const {boxes, fields, values, blocks, isSaved, isValid, loading: saveLoading, errors: saveErrors, success} = useSelector(state => state.metaStateReducer);\n    const {loading: fetchPageLoading, fetched: fetchedPage} = useSelector(state => state.fetchOptionPageReducer);\n    const {loading, fetched} = useSelector(state => state.fetchMetaReducer);\n\n    // manage local state\n    const didMountRef = useRef(false);\n    const [Prompt, setDirty, setPristine] = useUnsavedChangesWarning();\n    const [modalVisible, setModalVisible] = useState(false);\n\n    // set page meta title\n    useEffect(() => {\n        metaTitle(`${useTranslation(\"Option pages meta\")}${isSaved ? '' : '*'}`);\n        if(!isSaved){ setDirty(); }\n    }, [isSaved]);\n\n    // fetching data and\n    // populate the UI\n    useEffect(() => {\n        dispatch(fetchMeta(metaTypes.OPTION_PAGE, menuSlug));\n        dispatch(fetchOptionPage(menuSlug));\n    }, [saveLoading]);\n\n    // sortable\n    const onSortEnd = ({oldIndex, newIndex}) => {\n        dispatch(setBoxes(arrayMove(boxes, oldIndex, newIndex)));\n    };\n\n    // handle data submit\n    const handleSubmit = () => {\n        dispatch(metaSubmit(values));\n        dispatch(setStatusSaved());\n        setPristine();\n    };\n\n    const handleDeleteAll = () => {\n        dispatch(deleteAllMeta(metaTypes.OPTION_PAGE, menuSlug));\n        dispatch(setStatusSaved());\n        setPristine();\n    };\n\n    // handle form submission outcome\n    useEffect(() => {\n        if (didMountRef.current){\n            if(!saveLoading){\n                if(success){\n                    setPristine();\n                    toast.success(useTranslation(\"Option page meta successfully saved\"));\n                }\n\n                if(saveErrors.length > 0){\n                    saveErrors.map((error) => {\n                        toast.error(error);\n                    });\n                }\n            }\n        } else {\n            didMountRef.current = true;\n        }\n    }, [saveLoading]);\n\n    if(loading && fetchPageLoading){\n        return <Spinner />;\n    }\n\n    const renderDeleteButton = (\n        <React.Fragment>\n            <Modal title={useTranslation(\"Confirm deleting all\")} visible={modalVisible}>\n                <p>\n                    {useTranslation(\"Are you sure?\")}\n                </p>\n                <p>\n                    <a\n                        href=\"#\"\n                        className=\"acpt-btn acpt-btn-primary\"\n                        onClick={(e) => {\n                            e.preventDefault();\n                            setModalVisible(!modalVisible);\n                            handleDeleteAll();\n                        }}\n                    >\n                        {useTranslation(\"Yes\")}\n                    </a>\n                    &nbsp;\n                    <a\n                        href=\"#\"\n                        className=\"acpt-btn acpt-btn-primary-o\"\n                        onClick={(e) => {\n                            e.preventDefault();\n                            setModalVisible(!modalVisible);\n                        }}\n                    >\n                        {useTranslation(\"No\")}\n                    </a>\n                </p>\n            </Modal>\n            <button\n                onClick={(e) => {\n                    e.preventDefault();\n                    setModalVisible(true);\n                }}\n                type=\"submit\"\n                className=\"acpt-btn acpt-btn-danger\"\n            >\n                {useTranslation(\"Delete all\")}\n            </button>\n        </React.Fragment>\n    );\n\n    const buttons =\n        <React.Fragment>\n            <a\n                href=\"#\"\n                onClick={ (e) => {\n                    e.preventDefault();\n                    dispatch(createBox(metaTypes.OPTION_PAGE, menuSlug));\n                } }\n                className=\"acpt-btn acpt-btn-primary-o\"\n            >\n                {useTranslation(\"Add meta box\")}\n            </a>\n            {boxes.length > 0\n                ? (\n                    <React.Fragment>\n                        <button\n                            disabled={!isValid}\n                            onClick={(e) => {\n                                e.preventDefault();\n                                handleSubmit();\n                            }}\n                            type=\"submit\"\n                            className=\"acpt-btn acpt-btn-primary\"\n                        >\n                            {useTranslation(\"Save\")}\n                        </button>\n                        {renderDeleteButton}\n                    </React.Fragment>\n                ) : (\n                    <React.Fragment>\n                        {fetched.length > 0 && renderDeleteButton}\n                    </React.Fragment>\n                )}\n        </React.Fragment>\n    ;\n\n    return (\n        <Layout>\n            <ActionsBar\n                title={`${fetchedPage.menuTitle}: ${useTranslation(\"Manage meta fields\")}`}\n                actions={buttons}\n            />\n            <main className=\"\">\n                <Breadcrumbs crumbs={[\n                    {\n                        label: useTranslation(\"Option pages\"),\n                        link: \"/option-pages\"\n                    },\n                    {\n                        label: useTranslation(\"Manage meta fields\")\n                    }\n                ]} />\n                {Prompt}\n                <Meta\n                    id={`op_${menuSlug}_meta`}\n                    belongsTo={metaTypes.OPTION_PAGE}\n                    find={menuSlug}\n                    boxes={boxes}\n                    fields={fields}\n                    blocks={blocks}\n                    onSortEnd={onSortEnd}\n                    values={values}\n                />\n            </main>\n        </Layout>\n    );\n};\n\nexport default OptionPageMeta;","import {wpAjaxRequest} from \"../../utils/ajax\";\nimport {\n    fetchOptionPageFailure,\n    fetchOptionPageInProgress,\n    fetchOptionPageSuccess\n} from \"../actions/fetchOptionPageActions\";\n\nexport const fetchOptionPage = (slug) => async (dispatch, getState) => {\n    try {\n        dispatch(fetchOptionPageInProgress(slug));\n        const fetched = await wpAjaxRequest('fetchOptionPageAction', {slug:slug});\n        dispatch(fetchOptionPageSuccess(fetched));\n    } catch ( e ) {\n        dispatch(fetchOptionPageFailure(e));\n    }\n};"],"names":["OptionPageMeta","menuSlug","dispatch","state","metaStateReducer","boxes","fields","values","blocks","isSaved","isValid","saveLoading","loading","saveErrors","errors","success","fetchOptionPageReducer","fetchPageLoading","fetchedPage","fetched","fetchMetaReducer","didMountRef","Prompt","setDirty","setPristine","modalVisible","setModalVisible","metaTypes","OPTION_PAGE","onSortEnd","oldIndex","newIndex","handleSubmit","handleDeleteAll","current","toast","length","map","error","renderDeleteButton","e","preventDefault","buttons","menuTitle","label","link","fetchOptionPage","slug","getState"],"sourceRoot":""}