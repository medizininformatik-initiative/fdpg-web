var b=Object.defineProperty;var D=Object.getOwnPropertySymbols;var L=Object.prototype.hasOwnProperty,S=Object.prototype.propertyIsEnumerable;var _=(t,e,a)=>e in t?b(t,e,{enumerable:!0,configurable:!0,writable:!0,value:a}):t[e]=a,g=(t,e)=>{for(var a in e||(e={}))L.call(e,a)&&_(t,a,e[a]);if(D)for(var a of D(e))S.call(e,a)&&_(t,a,e[a]);return t};import{_ as o,b as p,a as h}from"./bi-490-178.js";const I=(t,e,a,c,l,d,r,i,s)=>{const n=g({},e);if(r){const u=g({},i);u[t.target.name]="",s(g({},u))}n[t.target.name]=t.target.value,a(g({},n))},A=(t,e,a,c,l)=>{c(!0);const d={formID:t,clientId:e.clientId,clientSecret:e.clientSecret,tokenDetails:e.tokenDetails},r=p(d,"selesforce_campaign_list").then(i=>i&&i.success?(a(s=>{var u;const n=g({},s);return n.default||(n.default={}),(u=n.default)!=null&&u.campaignLists||(n.default.campaignLists={}),i.data.allCampaignLists&&(n.default.campaignLists=i.data.allCampaignLists),i.data.tokenDetails&&(n.tokenDetails=i.data.tokenDetails),n}),c(!1),"Campaign list refreshed"):(c(!1),"Campaign list refresh failed. please try again"));h.promise(r,{success:i=>i,error:o("Error Occurred","bit-integrations"),loading:o("Loading Campaign list...")})},f=(t,e,a,c,l)=>{c(!0);const d={formID:t,clientId:e.clientId,clientSecret:e.clientSecret,tokenDetails:e.tokenDetails};p(d,"selesforce_lead_list").then(r=>r&&r.success?(a(i=>{var n;const s=g({},i);return s.default||(s.default={}),(n=s.default)!=null&&n.leadLists||(s.default.leadLists={}),r.data.leadLists&&(s.default.leadLists=r.data.leadLists),r.data.tokenDetails&&(s.tokenDetails=r.data.tokenDetails),s}),c(!1),"Lead list refreshed"):(c(!1),"Lead list refresh failed. please try again")).catch(()=>c(!1))},R=(t,e,a,c,l)=>{c(!0);const d={formID:t,clientId:e.clientId,clientSecret:e.clientSecret,tokenDetails:e.tokenDetails},r=p(d,"selesforce_contact_list").then(i=>i&&i.success?(a(s=>{var u;const n=g({},s);return n.default||(n.default={}),(u=n.default)!=null&&u.contactLists||(n.default.contactLists={}),i.data.contactLists&&(n.default.contactLists=i.data.contactLists),i.data.tokenDetails&&(n.tokenDetails=i.data.tokenDetails),n}),c(!1),"Contact list refresh successfully."):(c(!1),"Contact list refresh failed. please try again"));h.promise(r,{success:i=>i,error:o("Error Occurred","bit-integrations"),loading:o("Loading Contact list...")})},$=(t,e,a,c,l)=>{c(!0);const d={formID:t,clientId:e.clientId,clientSecret:e.clientSecret,tokenDetails:e.tokenDetails},r=p(d,"selesforce_account_list").then(i=>i&&i.success?(a(s=>{var u;const n=g({},s);return n.default||(n.default={}),(u=n.default)!=null&&u.accountLists||(n.default.accountLists={}),i.data.accountLists&&(n.default.accountLists=i.data.accountLists),i.data.tokenDetails&&(n.tokenDetails=i.data.tokenDetails),n}),c(!1),"Account list refreshed"):(c(!1),"Account list refresh failed. please try again"));h.promise(r,{success:i=>i,error:o("Error Occurred","bit-integrations"),loading:o("Loading Account list...")})},v=t=>!((t!=null&&t.field_map?t.field_map.filter(a=>!a.formField||!a.selesforceField||!a.formField==="custom"&&!a.customValue):[]).length>0),P=(t,e)=>{let a=[];e==="contact-create"?a=t==null?void 0:t.contactFields:e==="lead-create"?a=t==null?void 0:t.leadFields:e==="account-create"?a=t==null?void 0:t.accountFields:e==="campaign-create"?a=t==null?void 0:t.campaignFields:e==="add-campaign-member"?a=t==null?void 0:t.campaignMemberFields:e==="opportunity-create"?a=t==null?void 0:t.opportunityFields:e==="event-create"?a=t==null?void 0:t.eventFields:e==="case-create"&&(a=t==null?void 0:t.caseFields);const c=a.filter(l=>l.required===!0);return c.length>0?c.map(l=>({formField:"",selesforceField:l.key})):[{formField:"",selesforceField:""}]},q=(t,e,a,c,l,d)=>{if(!t.clientId||!t.clientSecret){a({clientId:t.clientId?"":o("Client ID cann't be empty","bit-integrations"),clientSecret:t.clientSecret?"":o("Secret key cann't be empty","bit-integrations")});return}l(!0);const r=`https://login.salesforce.com/services/oauth2/authorize?response_type=code&client_id=${t.clientId}&redirect_uri=${encodeURIComponent(window.location.href)}/redirect`,i=window.open(r,"salesforce","width=400,height=609,toolbar=off"),s=setInterval(()=>{if(i.closed){clearInterval(s);let n={},u=!1;const k=localStorage.getItem("__salesforce");if(k&&(u=!0,n=JSON.parse(k),localStorage.removeItem("__salesforce")),!n.code||n.error||!n||!u){const m=n.error?`Cause: ${n.error}`:"";d({show:!0,msg:`${o("Authorization failed","bit-integrations")} ${m}. ${o("please try again","bit-integrations")}`}),l(!1)}else{const m=g({},t);m.accountServer=n["accounts-server"],y(n,m,e,c,l,d)}}},500)},y=(t,e,a,c,l,d)=>{const r=g({},t);r.clientId=e.clientId,r.clientSecret=e.clientSecret,r.redirectURI=`${encodeURIComponent(window.location.href)}/redirect`,p(r,"selesforce_generate_token").then(i=>{if(i&&i.success){const s=g({},e);s.tokenDetails=i.data,a(s),c(!0),d({show:!0,msg:o("Authorized Successfully","bit-integrations")})}else i&&i.data&&i.data.data||!i.success&&typeof i.data=="string"?d({show:!0,msg:`${o("Authorization failed Cause:","bit-integrations")}${i.data.data||i.data}. ${o("please try again","bit-integrations")}`}):d({show:!0,msg:o("Authorization failed. please try again","bit-integrations")});l(!1)})};export{A as a,$ as b,v as c,R as d,f as e,q as f,P as g,I as h};
