var U=Object.defineProperty,G=Object.defineProperties;var q=Object.getOwnPropertyDescriptors;var $=Object.getOwnPropertySymbols;var J=Object.prototype.hasOwnProperty,K=Object.prototype.propertyIsEnumerable;var k=(r,c,i)=>c in r?U(r,c,{enumerable:!0,configurable:!0,writable:!0,value:i}):r[c]=i,b=(r,c)=>{for(var i in c||(c={}))J.call(c,i)&&k(r,i,c[i]);if($)for(var i of $(c))K.call(c,i)&&k(r,i,c[i]);return r},j=(r,c)=>G(r,q(c));import{j as t,r as v}from"./main.js";import{a8 as Q,R as I,$ as X,g as Y,h as y,B as M,i as Z,e as ee,c as te,_ as l,a7 as ae,E as A,a as w}from"./bi-490-178.js";import{S as se}from"./bi-652-725.js";import{C as ie}from"./bi-369-724.js";import{T as ne}from"./bi-771-767.js";import{a as le,E as oe}from"./bi-389-719.js";import{e as ce}from"./bi-266-720.js";import"./bi-422-718.js";function u({options:r,placeholder:c,action:i,className:x,isMultiple:C,allowCustomOpt:n,value:N,addable:a,titleClassName:d,title:h,jsonValue:m}){return t.jsxs("div",{className:`${d}`,children:[t.jsx("span",{children:h}),t.jsx(Q,{width:"100%",defaultValue:N,className:`btcd-paper-drpdwn msl-wrp-options ${x}`,onChange:i,singleSelect:!C,customValue:n||a,placeholder:c,jsonValue:m,options:r||[]})]})}function je({allIntegURL:r,isInfo:c,edit:i,isLearnDash:x=!1,learnDashConf:C}){var S,F,E;const[n,N]=I(X),[a,d]=I(Y),{userMail:h}=y(M),m=y(Z),[R,T]=v.useState(!1),B=ee(),[W,f]=v.useState({show:!1}),D=y(M),{isPro:_}=D,g=()=>{const e=[];if(L()){const s=[];m.map(o=>{o.type==="email"&&s.push({label:o.label,value:`\${${o.name}}`})}),e.push({title:"Form Fields",type:"group",childs:s})}return h&&Array.isArray(h)&&e.push({title:"WP Emails",type:"group",childs:h}),e};v.useEffect(()=>{if(n!=null&&n.flow_details||i){const e=b({},n==null?void 0:n.flow_details);d(e)}else{const e=b({},a);a&&!(a!=null&&a.type)&&(e.type=x?"LearnDash":"Mail"),a&&!(a!=null&&a.condition)&&(e.name=x?"Send Email Leader":"Mail Integrations",e.condition={action_behavior:"",actions:[{field:"",action:"value"}],logics:[{field:"",logic:"",val:""},"or",{field:"",logic:"",val:""}]},d(e))}},[]);const H=(e,s)=>{const o=b({},a);s?o.condition.action_behavior=e:o.condition.action_behavior="",d(o)},p=(e,s)=>{const o=b({},a);e==="to"?o.to=s?s.split(","):[]:e==="cc"?o.cc=s?s.split(","):[]:e==="bcc"?o.bcc=s?s.split(","):[]:e==="replyto"?o.replyto=s?s.split(","):[]:e==="attachment"?o.attachment=s?s.split(","):[]:o[e]=s,d(o)},L=()=>{for(const e of m)if(e.type==="email")return!0;return!1},P=()=>{const e=[];for(const s of m)s.type==="file"&&e.push({label:s.label,value:s.name});return e},V=({target:{value:e}})=>{d(s=>j(b({},s),{subject:(s.subject!==void 0?s.subject:"")+e})),setTimeout(()=>{e=""},100)},z=()=>{if(!a.name){f({show:!0,msg:l("Integration Name cann't be empty","bit-integrations")});return}if(!a.to){f({show:!0,msg:l("Email Receiver cann't be empty","bit-integrations")});return}const e=j(b({},a),{learnDashConf:C});ce(n,N,r,e,B,"",i,T).then(o=>{o.success?(i&&w.success("Integration Updated Successfully"),w.success("Integration Created Successfully")):w.error(o.data||o)})},O=e=>{d(s=>j(b({},s),{body:e}))};return t.jsxs("div",{children:[t.jsx(te,{snack:W,setSnackbar:f}),t.jsx("span",{className:"f-m wdt-200 d-in-b",children:l("Integration Name","bit-integration")}),t.jsx("input",{className:"btcd-paper-inp w-5 mt-1",onChange:e=>p("name",e.target.value),name:"name",value:a.name,type:"text",placeholder:l("Integration Name...","bit-integrations"),disabled:c}),t.jsx("br",{}),t.jsx("br",{}),n.triggered_entity==="Webhook"&&(n==null?void 0:n.flow_details)&&t.jsx(le,{setSnackbar:f}),n.triggered_entity!=="Webhook"&&(n==null?void 0:n.flow_details)&&t.jsx(oe,{setSnackbar:f}),t.jsx(u,{action:e=>p("from",e),placeholder:l("Add mail from address","bit-integrations"),value:a.from,title:t.jsx("span",{className:"f-m wdt-200 d-in-b",children:l("From","bit-integrations")}),titleClassName:"mt-2 flx",className:"w-5",addable:!0,options:g(a.from)}),t.jsx(u,{action:e=>p("to",e),value:a.to,placeholder:l("Add Email Receiver","bit-integrations"),title:t.jsx("span",{className:"f-m wdt-200 d-in-b",children:l("To","bit-integrations")}),isMultiple:!0,titleClassName:"mt-2 flx",className:"w-5",addable:!0,options:g(a.to)}),t.jsx(u,{action:e=>p("cc",e),value:a.cc,placeholder:l("Add Email CC","bit-integrations"),title:t.jsx("span",{className:"f-m wdt-200 d-in-b",children:l("CC","bit-integrations")}),isMultiple:!0,titleClassName:"mt-2 flx",className:"w-5",addable:!0,options:g(a.cc)}),t.jsx(u,{action:e=>p("bcc",e),placeholder:l("Add Email BCC","bit-integrations"),value:a.bcc,title:t.jsx("span",{className:"f-m wdt-200 d-in-b",children:l("BCC","bit-integrations")}),isMultiple:!0,titleClassName:"mt-2 flx",className:"w-5",addable:!0,options:g(a.bcc)}),t.jsx(u,{action:e=>p("replyto",e),placeholder:l("Reply To","bit-integrations"),value:a.replyto,title:t.jsx("span",{className:"f-m wdt-200 d-in-b",children:l("Reply To","bit-integrations")}),isMultiple:!0,titleClassName:"mt-2 flx",className:"w-5",addable:!0,options:g(a.replyto)}),t.jsx(u,{action:e=>p("attachment",e),placeholder:l("Attachment","bit-integrations"),value:(a==null?void 0:a.attachment)||[],title:t.jsx("span",{className:"f-m wdt-200 d-in-b",children:l("Attachment","bit-integrations")}),isMultiple:!0,disableChip:!1,customValue:!1,addable:!0,titleClassName:"mt-2 flx",className:"w-5",options:P()}),t.jsxs("div",{className:"mt-2 mb-4 flx",children:[t.jsx("span",{className:"f-m wdt-200 d-in-b",children:"Subject:"}),t.jsx("input",{onChange:e=>p("subject",e.target.value),name:"sub",type:"text",className:"btcd-paper-inp w-5",placeholder:"Email Subject Here",value:a.subject}),t.jsxs("select",{onChange:V,className:"btcd-paper-inp ml-2",style:{width:"20%"},children:[t.jsx("option",{value:"",children:l("Add field","bit-integrations")}),t.jsx("optgroup",{label:"Form Fields",children:m!==null&&m.map(e=>e.type!==void 0&&!e.type.match(/^(file|recaptcha)$/)&&t.jsx("option",{value:`\${${e.name}}`,children:e.label},e.name))}),t.jsx("optgroup",{label:`General Smart Codes ${_?"":"(PRO)"}`,children:_&&((S=se)==null?void 0:S.map(e=>t.jsx("option",{value:`\${${e.name}}`,children:e.label},`ff-rm-${e.name}`)))})]})]}),t.jsx(ne,{id:"conf-mail",formFields:m,value:a.body,onChangeHandler:O,width:"100%"}),(a==null?void 0:a.condition)&&t.jsxs(t.Fragment,{children:[t.jsx("div",{className:"flx",children:t.jsx(ae,{onChange:e=>H(e.target.value,e.target.checked),checked:((F=a==null?void 0:a.condition)==null?void 0:F.action_behavior)==="cond",className:"wdt-200 mt-4 mr-2",value:"cond",title:l("Conditional Logics","bit_integration")})}),t.jsx("br",{}),((E=a==null?void 0:a.condition)==null?void 0:E.action_behavior)==="cond"&&t.jsx(ie,{formFields:m,dataConf:a,setDataConf:d})]}),t.jsx(re,{saveConfig:z,isLoading:R,edit:(n==null?void 0:n.flow_details)&&!0})]})}const re=({saveConfig:r,edit:c,isLoading:i})=>c?t.jsx("div",{className:"txt-center w-9 mt-3",children:t.jsxs("button",{onClick:r,className:"btn btcd-btn-lg green sh-sm flx",type:"button",disabled:i,children:[l("Update","bit-integrations"),i&&t.jsx(A,{size:20,clr:"#022217",className:"ml-2"})]})}):t.jsx("div",{className:"btcd-stp-page txt-center",style:{width:"100%",height:"auto"},children:t.jsxs("button",{onClick:r,className:"btn btcd-btn-lg green sh-sm",type:"button",disabled:i,children:[l("Save ","bit-integrations"),"âœ”",i&&t.jsx(A,{size:20,clr:"#022217",className:"ml-2"})]})});export{je as default};
