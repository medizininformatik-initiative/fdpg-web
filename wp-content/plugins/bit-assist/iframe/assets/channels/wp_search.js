const wp_search={renderWPSearch(e){this.hideChannels(),this.renderCard(),this.setCardStyle(e);const t=createElm("div",{id:"wpSearchBody"}),a=createElm("div",{id:"listWrapper"}),n=createElm("div",{id:"lists","data-link_open_action":e.open_window_action}),l=createElm("input",{type:"text",id:"listSearch",class:"formControl",placeholder:"Search"});globalAppend(a,[n,l]),globalAppend(t,a),globalInnerHTML(this.cardBody,""),globalAppend(this.cardBody,t),this.searchPostPage(""),globalEventListener(l,"input",this.debounce((e=>this.searchPostPage(e.target.value)),600))},async searchPostPage(e,t=1){const{data:a,pagination:n}=await this.fetchWPSearchData(e,t);this.renderWPSearchItem(a),(n?.has_next||n?.has_previous)&&this.renderWPSearchPagination(n),this.resetClientWidgetSize()},async fetchWPSearchData(e,t){const{data:a}=await fetch(`${this.apiEndPoint}/wpSearch`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({search:e,page:t})}).then((e=>e.json()));return a},renderWPSearchItem(e){const t=$("#lists");globalInnerHTML(t,"");const a=[];e?.forEach((e=>{const n=createElm("div",{class:"listItem"}),l=createElm("button",{class:"listItemTitleWrapper",title:e.guid}),s=createElm("p",{class:"title"}),i=createElm("p",{class:"type"});globalAppend(n,l),globalAppend(l,[s,i]),globalInnerText(s,e?.post_title||"(no title)"),globalInnerText(i,e?.post_type||""),a.push(n),globalEventListener(l,"click",(()=>{const{link_open_action:a}=t.dataset;"new_window"===a?window.open(e.guid,"_blank","popup"):window.open(e.guid,a)}))})),globalAppend(t,a)},renderWPSearchPagination(e){const t=createElm("div",{class:"pagination"}),a=createElm("span",{class:"pageNumber"});globalInnerText(a,`${e?.current} / ${e?.total} page`);const n=createElm("button",{class:"nextPage"});globalInnerText(n,"Next"),e?.has_next||globalSetAttribute(n,"disabled","");const l=createElm("button",{class:"prevPage"});globalInnerText(l,"Prev"),e?.has_previous||globalSetAttribute(l,"disabled","");const s=$("#listSearch")?.value||"";globalEventListener(n,"click",(()=>this.searchPostPage(s,e?.next))),globalEventListener(l,"click",(()=>this.searchPostPage(s,e?.previous))),globalAppend(t,[l,n,a]),globalAppend($("#lists"),t)}};export{wp_search};
