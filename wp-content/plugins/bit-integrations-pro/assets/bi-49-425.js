var U=Object.defineProperty;var F=Object.getOwnPropertySymbols;var W=Object.prototype.hasOwnProperty,B=Object.prototype.propertyIsEnumerable;var k=(c,r,l)=>r in c?U(c,r,{enumerable:!0,configurable:!0,writable:!0,value:l}):c[r]=l,f=(c,r)=>{for(var l in r||(r={}))W.call(r,l)&&k(c,l,r[l]);if(F)for(var l of F(r))B.call(r,l)&&k(c,l,r[l]);return c};import{r as p,j as e}from"./main.js";import{e as G,f as J,b as v,c as K,_ as i,ae as _}from"./bi-490-178.js";import{S as Q}from"./bi-224-925.js";import{r as V,F as X,a as Y,C as Z,c as T,b as ee,d as te}from"./bi-280-780.js";import{p as I}from"./bi-666-755.js";import{e as se}from"./bi-266-720.js";import{I as ie}from"./bi-811-721.js";import"./bi-422-718.js";import"./bi-652-725.js";import"./bi-528-726.js";import"./bi-369-724.js";function fe({formFields:c,setFlow:r,flow:l,allIntegURL:N}){var C;const[g,q]=p.useState([]),[x,y]=p.useState([]),S=G(),{formID:M}=J(),[w,j]=p.useState(!1),[u,D]=p.useState(1),[A,d]=p.useState({show:!1}),[$,z]=p.useState({fields:[],files:[]}),[E,L]=p.useState({fields:[],files:[]}),[a,h]=p.useState({name:"Post Creation",type:"Post Creation",post_map:[{post_author:"logged_in_user"}],acf_map:[{}],acf_file_map:[{}],metabox_map:[{}],metabox_file_map:[{}]}),b=(t,s)=>{const n=f({},a);n[t]=s,h(n)};p.useEffect(()=>{v({},"user/list").then(s=>{const{data:n}=s;q(n)}),v({},"post-types/list").then(s=>{const{data:n}=s;y(n)});const t=f({},a);t.post_map=I.filter(s=>s.required).map(s=>({formField:"",postField:s.key,required:s.required})),h(t)},[]);const O=(t,s)=>{const n=f({},a);n[t]=s,v({post_type:s},"customfield/list").then(R=>{const{data:o}=R;z({fields:o.acf_fields,files:o.acf_files}),L({fields:o.mb_fields,files:o.mb_files}),o!=null&&o.acf_fields&&(n.acf_map=o.acf_fields.filter(m=>m.required).map(m=>({formField:"",acfField:m.key,required:m.required})),n.acf_map.length<1&&(n.acf_map=[{}])),o!=null&&o.mb_fields&&(n.metabox_map=o.mb_fields.filter(m=>m.required).map(m=>({formField:"",metaboxField:m.key,required:m.required})),n.metabox_map.length<1&&(n.metabox_map=[{}]))}),h(n)},P=t=>{if(!T(a)){d({show:!0,msg:i("Please map mandatory fields","bit-integrations")});return}if(!a.post_type){d({show:!0,msg:i("Post Type cann't be empty","bit-integrations")});return}if(!a.post_status){d({show:!0,msg:i("Post Status cann't be empty","bit-integrations")});return}if(t===3){if(!ee(a)){d({show:!0,msg:i("Please map mandatory fields","bit-integrations")});return}if(!te(a)){d({show:!0,msg:i("Please map mandatory fields","bit-integrations")});return}}D(t),document.querySelector(".btcd-s-wrp").scrollTop=0},H=()=>{j(!0),se(l,r,N,a,S,"","",j).then(s=>{var n;s.success?(d({show:!0,msg:(n=s.data)==null?void 0:n.msg}),S.push(N)):d({show:!0,msg:s.data||s})})};return e.jsxs("div",{children:[e.jsx(K,{snack:A,setSnackbar:d}),e.jsx("div",{className:"txt-center mt-2",children:e.jsx(Q,{step:3,active:u})}),e.jsxs("div",{className:"btcd-stp-page",style:{width:u===1&&900,height:u===1&&"auto"},children:[e.jsx("div",{className:"mt-3",children:e.jsx("b",{children:i("Integration Name ","bit-integrations")})}),e.jsx("input",{className:"btcd-paper-inp w-5 mt-1",onChange:t=>b(t.target.name,t.target.value),name:"name",value:a.name,type:"text",placeholder:i("Integration Name...","bit-integrations")}),e.jsxs("div",{className:"mt-3 flx",children:[e.jsx("b",{children:i("Post Type","bit-integrations")}),e.jsx(_,{width:250,icnSize:17,className:"ml-2",children:e.jsxs("div",{className:"txt-body",children:["Select one of the defined WordPress post types Or custom post types for the post.",e.jsx("br",{})]})})]}),e.jsxs("div",{children:[e.jsxs("select",{name:"post_type",onChange:t=>O(t.target.name,t.target.value),className:"btcd-paper-inp w-5 mt-1",children:[e.jsx("option",{disabled:!0,selected:!0,children:"Select Post Type"}),x==null?void 0:x.map((t,s)=>e.jsx("option",{value:t==null?void 0:t.id,children:t==null?void 0:t.title},`acf-${s*2}`))]}),e.jsx("button",{onClick:()=>V(x,y),className:"icn-btn sh-sm ml-2 mr-2 tooltip",style:{"--tooltip-txt":`'${i("Refresh Post Types","bit-integrations")}'`},type:"button",children:"â†»"})]}),e.jsxs("div",{className:"mt-3",children:[e.jsx("b",{children:i("Post Status","bit-integrations")}),e.jsx(_,{width:250,icnSize:17,className:"ml-2",children:e.jsxs("div",{className:"txt-body",children:["Select the status for the post. If published status is selected and the post date is in the future, it will automatically be changed to scheduled",e.jsx("br",{})]})})]}),e.jsxs("select",{name:"post_status",onChange:t=>b(t.target.name,t.target.value),className:"btcd-paper-inp w-5 mt-2",children:[e.jsx("option",{disabled:!0,selected:!0,children:i("Select Status","bit-integrations")}),e.jsx("option",{value:"publish",children:"Publish"}),e.jsx("option",{value:"draft",children:"Draft"}),e.jsx("option",{value:"auto-draft",children:"Auto-Draft"}),e.jsx("option",{value:"private",children:"Private"}),e.jsx("option",{value:"pending",children:"Pending"})]}),e.jsxs("div",{className:"mt-3 flx",children:[e.jsx("b",{children:i("Author","bit-integrations")}),e.jsx(_,{width:250,icnSize:17,className:"ml-2",children:e.jsxs("div",{className:"txt-body",children:["Select the user to be assigned to the post.",e.jsx("br",{})]})})]}),e.jsx("div",{children:e.jsxs("select",{name:"post_author",onChange:t=>b(t.target.name,t.target.value),className:"btcd-paper-inp w-5 mt-2",children:[e.jsx("option",{disabled:!0,selected:!0,children:i("Select Author","bit-integrations")}),e.jsx("option",{value:"logged_in_user",children:"Logged In User"}),g==null?void 0:g.map((t,s)=>e.jsx("option",{value:t.ID,children:t.display_name},`acf-${s*2}`))]})}),e.jsx("div",{className:"mt-3",children:e.jsx("b",{children:i("Comment Status","bit-integrations")})}),e.jsxs("select",{name:"comment_status",onChange:t=>b(t.target.name,t.target.value),className:"btcd-paper-inp w-5 mt-2",children:[e.jsx("option",{disabled:!0,selected:!0,children:i("Select Status","bit-integrations")}),e.jsx("option",{value:"open",children:"Open"}),e.jsx("option",{value:"closed",children:"Closed"})]}),e.jsxs("div",{children:[e.jsx("div",{className:"mt-3 mb-1",children:e.jsx("b",{children:i("Post Field Mapping","bit-integrations")})}),e.jsx("div",{className:"btcd-hr"}),e.jsxs("div",{className:"flx flx-around mt-2 mb-2 btcbi-field-map-label",children:[e.jsx("div",{className:"txt-dp",children:e.jsx("b",{children:i("Form Fields","bit-integrations")})}),e.jsx("div",{className:"txt-dp",children:e.jsx("b",{children:i("Post Fields","bit-integrations")})})]})]}),(C=a==null?void 0:a.post_map)==null?void 0:C.map((t,s)=>e.jsx(X,{i:s,type:"post",field:t,formFields:c,postConf:a,setPostConf:h,customFields:I},`analytics-m-${s+9}`)),e.jsx("div",{className:"txt-center btcbi-field-map-button mt-2",children:e.jsx("button",{onClick:()=>Y("post_map",a.post_map.length,a,h),className:"icn-btn sh-sm",type:"button",children:"+"})}),e.jsxs("button",{onClick:()=>P(2),className:"btn f-right btcd-btn-lg green sh-sm flx",type:"button",children:[i("Next","bit-integrations"),e.jsx("div",{className:"btcd-icn icn-arrow_back rev-icn d-in-b"})]})]}),e.jsxs("div",{className:"btcd-stp-page",style:f({},u===2&&{width:900,height:"auto",overflow:"visible"}),children:[e.jsx(Z,{formID:M,formFields:c,handleInput:t=>b(t,a),postConf:a,setPostConf:h,isLoading:w,setIsLoading:j,setSnackbar:d,acfFields:$,mbFields:E}),e.jsxs("button",{onClick:()=>P(3),className:"btn f-right btcd-btn-lg green sh-sm flx",type:"button",children:[i("Next","bit-integrations"),e.jsx("div",{className:"btcd-icn icn-arrow_back rev-icn d-in-b"})]})]}),e.jsx(ie,{step:u,saveConfig:()=>H(),isLoading:w,dataConf:a,setDataConf:h,formFields:c})]})}export{fe as default};
