var K=Object.defineProperty;var q=Object.getOwnPropertySymbols;var Q=Object.prototype.hasOwnProperty,X=Object.prototype.propertyIsEnumerable;var E=(t,i,a)=>i in t?K(t,i,{enumerable:!0,configurable:!0,writable:!0,value:a}):t[i]=a,p=(t,i)=>{for(var a in i||(i={}))Q.call(i,a)&&E(t,a,i[a]);if(q)for(var a of q(i))X.call(i,a)&&E(t,a,i[a]);return t};import{r as y,j as e,L as k}from"./main.js";import{a7 as V,_ as n,d as H,a8 as T,h as L,B as P}from"./bi-490-178.js";import{S as A}from"./bi-652-725.js";import{h as Y,a as Z}from"./bi-266-720.js";import{f as B,g as W}from"./bi-955-812.js";import{T as I}from"./bi-699-739.js";import{T as D}from"./bi-528-726.js";function G({groundhoggConf:t,setGroundhoggConf:i,formFields:a}){var b,M,_,$;const[s,m]=y.useState(!1),[r,h]=y.useState({show:!1,action:()=>{}}),N=(d,u)=>{var O,R;const F=p({},t);u==="tag"&&((O=d.target)!=null&&O.checked?F.actions.tags=!0:delete F.actions.tags),u==="optin_status_open"&&((R=d.target)!=null&&R.checked?F.optin_status_open=!0:delete F.optin_status_open),i(p({},F))},j=()=>{h({show:!1})},v=d=>{const u=p({},t);d?u.actions.tags=d:delete u.actions.tags,i(p({},u))},l=d=>{const u=p({},t);d?u.optin_status=d:u.optin_status="1",i(p({},u))},x=()=>{h({show:"tag"})},w=()=>{h({show:"optin_status"})},o=[{type:"group",title:"Groundhogg Tags",childs:(((b=t==null?void 0:t.default)==null?void 0:b.tags)||[]).map(({tag_name:d})=>({label:d,value:`ground-${d}`}))},{type:"group",title:"Form Fields",childs:a.map(d=>({label:d.label,value:d.name}))},{type:"group",title:"Special Tags",childs:(M=A)==null?void 0:M.map(d=>({label:d.label,value:d.name}))}],c=[{label:"Unconfirmed",value:"1"},{label:"Confirmed",value:"2"},{label:"Unsubscribed",value:"3"},{label:"Weekly",value:"4"},{label:"Monthly",value:"5"},{label:"Bounced",value:"6"},{label:"Spam",value:"7"},{label:"Complained",value:"8"}];return e.jsxs("div",{className:"d-flx wdt-300",children:[e.jsxs("div",{className:"pos-rel d-flx w-8",children:[e.jsx(I,{action:x,children:e.jsx(V,{checked:((_=t==null?void 0:t.actions)==null?void 0:_.tags)||!1,onChange:d=>N(d,"tag"),className:"wdt-200 mt-4 mr-2",value:"tags",title:n("Add Tags","bit-integrations"),subTitle:n("Add Contact Tag","bit-integrations")})}),e.jsxs(H,{className:"custom-conf-mdl",mainMdlCls:"o-v",btnClass:"blue",btnTxt:n("Ok","bit-integrations"),show:r.show==="tag",close:j,action:j,title:n("Tags","bit-integrations"),children:[e.jsx("div",{className:"btcd-hr mt-2 mb-2"}),e.jsx("div",{className:"mt-2",children:n("Select tag","bit-integrations")}),s?e.jsx(k,{style:{display:"flex",justifyContent:"center",alignItems:"center",height:45,transform:"scale(0.5)"}}):e.jsxs("div",{className:"flx flx-between mt-2",children:[e.jsx(T,{options:o,className:"msl-wrp-options",defaultValue:($=t.actions)==null?void 0:$.tags,onChange:d=>v(d),customValue:!0}),e.jsx("button",{onClick:()=>B(null,t,i,m),className:"icn-btn sh-sm ml-2 mr-4 tooltip",style:{"--tooltip-txt":`'${n("Refresh Groundhogg Tags","bit-integrations")}'`},type:"button",disabled:s,children:"↻"})]})]})]}),e.jsxs("div",{className:"pos-rel d-flx w-8",children:[e.jsx(I,{action:w,children:e.jsx(V,{checked:(t==null?void 0:t.optin_status_open)||!1,onChange:d=>N(d,"optin_status_open"),className:"wdt-200 mt-4 mr-2",value:"optin_status_open",title:n("Optin Status ","bit-integrations"),subTitle:n("Add optin status ","bit-integrations")})}),e.jsxs(H,{className:"custom-conf-mdl",mainMdlCls:"o-v",btnClass:"blue",btnTxt:n("Ok","bit-integrations"),show:r.show==="optin_status",close:j,action:j,title:n("Optin status","bit-integrations"),children:[e.jsx("div",{className:"btcd-hr mt-2 mb-2"}),e.jsx("div",{className:"mt-2",children:n("Select Optin status","bit-integrations")}),s?e.jsx(k,{style:{display:"flex",justifyContent:"center",alignItems:"center",height:45,transform:"scale(0.5)"}}):e.jsx("div",{className:"flx flx-between mt-2",children:e.jsx(T,{options:c,className:"msl-wrp-options",defaultValue:t.optin_status,onChange:d=>l(d),singleSelect:!0})})]})]})]})}const f=(t,i,a)=>{const s=p({},i);s.field_map.splice(t,0,{}),a(p({},s))},C=(t,i,a)=>{const s=p({},i);s.field_map.length>1&&s.field_map.splice(t,1),a(p({},s))},J=(t,i,a)=>{const s=p({},i);s.field_map_meta.splice(t,0,{}),a(p({},s))},g=(t,i,a)=>{const s=p({},i);s.field_map_meta.length>1&&s.field_map_meta.splice(t,1),a(p({},s))},U=(t,i,a,s)=>{const m=p({},a);m.field_map[i][t.target.name]=t.target.value,t.target.value==="custom"&&(m.field_map[i].customValue=""),s(p({},m))},z=(t,i,a,s)=>{const m=p({},a);m.field_map_meta[i][t.target.name]=t.target.value,t.target.value==="custom"&&(m.field_map_meta[i].customMetaFormValue=""),s(p({},m))},ee=(t,i,a,s)=>{const m=p({},a);m.field_map_meta[i].customMetaFormValue=t,s(p({},m))};function te({i:t,formFields:i,field:a,groundhoggConf:s,setGroundhoggConf:m}){var v;y.useEffect(()=>{var l;if(((l=s==null?void 0:s.field_map)==null?void 0:l.length)===1&&a.GroundhoggMapField===""){const x=p({},s),w=W(x);x.field_map=w,m(x)}},[]);const r=(s==null?void 0:s.contactsFields.filter(l=>l.required===!0))||[],h=(s==null?void 0:s.contactsFields.filter(l=>l.required===!1))||[],N=L(P),{isPro:j}=N;return e.jsx("div",{className:"flx mt-2 mb-2 btcbi-field-map",children:e.jsxs("div",{className:"pos-rel flx",children:[e.jsxs("div",{className:"flx integ-fld-wrp",children:[e.jsxs("select",{className:"btcd-paper-inp mr-2",name:"formField",value:a.formField||"",onChange:l=>U(l,t,s,m),children:[e.jsx("option",{value:"",children:n("Select Field","bit-integrations")}),e.jsx("optgroup",{label:"Form Fields",children:i==null?void 0:i.map(l=>e.jsx("option",{value:l.name,children:l.label},`ff-rm-${l.name}`))}),e.jsx("option",{value:"custom",children:n("Custom...","bit-integrations")}),e.jsx("optgroup",{label:`General Smart Codes ${j?"":"(PRO)"}`,children:j&&((v=A)==null?void 0:v.map(l=>e.jsx("option",{value:l.name,children:l.label},`ff-gh-${l.name}`)))})]}),a.formField==="custom"&&e.jsx(D,{onChange:l=>Y(l,t,s,m),label:n("Custom Value","bit-integrations"),className:"mr-2",type:"text",value:a.customValue,placeholder:n("Custom Value","bit-integrations"),formFields:i}),e.jsxs("select",{className:"btcd-paper-inp",disabled:t<r.length,name:"GroundhoggMapField",value:t<r.length?r[t].key||"":a.GroundhoggMapField||"",onChange:l=>U(l,t,s,m),children:[e.jsx("option",{value:"",children:n("Select Field","bit-integrations")}),t<r.length?e.jsx("option",{value:r[t].key,children:r[t].label},r[t].key):h.map(({key:l,label:x})=>e.jsx("option",{value:l,children:x},l))]})]}),t>=r.length&&e.jsxs(e.Fragment,{children:[e.jsx("button",{onClick:()=>f(t,s,m),className:"icn-btn sh-sm ml-2 mr-1",type:"button",children:"+"}),e.jsx("button",{onClick:()=>C(t,s,m),className:"icn-btn sh-sm ml-1",type:"button","aria-label":"btn",children:e.jsx("span",{className:"btcd-icn icn-trash-2"})})]})]})})}function ae({i:t,formFields:i,field:a,groundhoggConf:s,setGroundhoggConf:m}){var v;y.useEffect(()=>{var l;if(((l=s==null?void 0:s.field_map_meta)==null?void 0:l.length)===1&&a.GroundhoggMetaMapField===""){const x=p({},s),w=W(x);x.field_map_meta=w,m(x)}},[]);const r=(s==null?void 0:s.contactMetaFields.filter(l=>l.required===!0))||[],h=(s==null?void 0:s.contactMetaFields.filter(l=>l.required===!1))||[],N=L(P),{isPro:j}=N;return e.jsx("div",{className:"flx mt-2 mb-2 btcbi-field-map",children:e.jsxs("div",{className:"pos-rel flx",children:[e.jsxs("div",{className:"flx integ-fld-wrp",children:[e.jsxs("select",{className:"btcd-paper-inp mr-2",name:"formField",value:a.formField||"",onChange:l=>z(l,t,s,m),children:[e.jsx("option",{value:"",children:n("Select Field","bit-integrations")}),e.jsx("optgroup",{label:"Form Fields",children:i==null?void 0:i.map(l=>e.jsx("option",{value:l.name,children:l.label},`ff-rm-${l.name}`))}),e.jsx("option",{value:"custom",children:n("Custom...","bit-integrations")}),e.jsx("optgroup",{label:`General Smart Codes ${j?"":"(PRO)"}`,children:j&&((v=A)==null?void 0:v.map(l=>e.jsx("option",{value:l.name,children:l.label},`ff-gh-${l.name}`)))})]}),a.formField==="custom"&&e.jsx(D,{onChange:l=>ee(l,t,s,m),label:n("Custom Value","bit-integrations"),className:"mr-2",type:"text",value:a.customMetaFormValue,placeholder:n("Custom Value","bit-integrations"),formFields:i}),e.jsxs("select",{className:"btcd-paper-inp",disabled:t<r.length,name:"GroundhoggMetaMapField",value:t<r.length?r[t].key||"":a.GroundhoggMetaMapField||"",onChange:l=>z(l,t,s,m),children:[e.jsx("option",{value:"",children:n("Select Field","bit-integrations")}),t<r.length?e.jsx("option",{value:r[t].key,children:r[t].label},r[t].key):h.map(({key:l,label:x})=>e.jsx("option",{value:l,children:x},l))]})]}),t>=r.length&&e.jsxs(e.Fragment,{children:[e.jsx("button",{onClick:()=>J(t,s,m),className:"icn-btn sh-sm ml-2 mr-1",type:"button",children:"+"}),e.jsx("button",{onClick:()=>g(t,s,m),className:"icn-btn sh-sm ml-1",type:"button","aria-label":"btn",children:e.jsx("span",{className:"btcd-icn icn-trash-2"})})]})]})})}function re({formFields:t,handleInput:i,groundhoggConf:a,setGroundhoggConf:s,isLoading:m,setIsLoading:r,setSnackbar:h}){var S,o;const N=(c,b)=>{var _;const M=p({},a);b==="showMeta"&&((_=c.target)!=null&&_.checked?M.showMeta=!0:delete M.showMeta),s(p({},M))},j=c=>{const b=p({},a);c?b.addTagToUser=c:b.addTagToUser="",s(p({},b))},v=c=>{const b=p({},a);c?b.emailAddress=c:b.emailAddress="",s(p({},b))},x=[{type:"group",title:"Groundhogg Tags",childs:(((S=a==null?void 0:a.default)==null?void 0:S.tags)||[]).map(({tag_name:c})=>({label:c,value:`ground-${c}`}))},{type:"group",title:"Form Fields",childs:t.map(c=>({label:c.label,value:c.name}))},{type:"group",title:"Special Tags",childs:(o=A)==null?void 0:o.map(c=>({label:c.label,value:c.name}))}],w=t.filter(c=>c.type==="email").map(c=>({label:c.label,value:c.name}));return e.jsxs(e.Fragment,{children:[e.jsx("br",{}),e.jsx("b",{className:"wdt-200 d-in-b",children:n("Actions:","bit-integrations")}),e.jsxs("select",{onChange:i,name:"mainAction",value:a.mainAction,className:"btcd-paper-inp w-5",children:[e.jsx("option",{value:"",children:n("Select Actions","bit-integrations")}),a.allActions&&a.allActions.map(({key:c,label:b})=>e.jsx("option",{value:c,children:b},c))]}),e.jsx("br",{}),e.jsx("br",{}),a.mainAction==="2"&&e.jsxs("div",{className:"d-flx",children:[e.jsx("b",{className:"wdt-200 d-in-b mt-3 mt-i-3",children:n("Email:","bit-integrations")}),e.jsx(T,{options:w.map(c=>({label:c.label,value:c.value})),className:"btcd-paper-drpdwn w-5",defaultValue:a.emailAddress,onChange:c=>v(c)})]}),m&&e.jsx(k,{style:{display:"flex",justifyContent:"center",alignItems:"center",height:100,transform:"scale(0.7)"}}),e.jsx("br",{}),a.mainAction==="1"&&e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"mt-5",children:e.jsx("b",{className:"wdt-100",children:n("Field Map","bit-integrations")})}),e.jsx("div",{className:"btcd-hr mt-1"}),e.jsxs("div",{className:"flx flx-around mt-2 mb-2 btcbi-field-map-label",children:[e.jsx("div",{className:"txt-dp",children:e.jsx("b",{children:n("Form Fields","bit-integrations")})}),e.jsx("div",{className:"txt-dp",children:e.jsx("b",{children:n("Groundhogg Fields","bit-integrations")})})]}),a==null?void 0:a.field_map.map((c,b)=>e.jsx(te,{i:b,field:c,groundhoggConf:a,formFields:t,setGroundhoggConf:s},`rp-m-${b+9}`)),e.jsx("div",{className:"txt-center btcbi-field-map-button mt-2",children:e.jsx("button",{onClick:()=>Z(a.field_map.length,a,s,!1),className:"icn-btn sh-sm",type:"button",children:"+"})}),e.jsx(V,{checked:(a==null?void 0:a.showMeta)||!1,onChange:c=>N(c,"showMeta"),className:"wdt-200 mt-4 mr-2",value:"showMeta",title:n("Add Meta field","bit-integrations")})]}),e.jsx("br",{}),a.mainAction==="1"&&a.showMeta&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"flx flx-around mt-2 mb-2 btcbi-field-map-label",children:[e.jsx("div",{className:"txt-dp",children:e.jsx("b",{children:n("Form Fields","bit-integrations")})}),e.jsx("div",{className:"txt-dp",children:e.jsx("b",{children:n("Groundhogg Meta Fields","bit-integrations")})})]}),a==null?void 0:a.field_map_meta.map((c,b)=>e.jsx(ae,{i:b,field:c,groundhoggConf:a,formFields:t,setGroundhoggConf:s},`rp-m-${b+9}`))]}),a.mainAction==="1"&&a.showMeta&&e.jsx("div",{className:"txt-center btcbi-field-map-button mt-2",children:e.jsx("button",{onClick:()=>J(a.field_map_meta.length,a,s),className:"icn-btn sh-sm",type:"button",children:"+"})}),a.mainAction==="2"&&e.jsxs("div",{className:"d-flx",children:[e.jsx("b",{className:"wdt-200 d-in-b mt-3 mt-i-3",children:n("All Tags:","bit-integrations")}),e.jsx(T,{options:x,className:"btcd-paper-drpdwn w-5",defaultValue:a.addTagToUser,onChange:c=>j(c),customValue:!0}),e.jsx("button",{onClick:()=>B(null,a,s,r),className:"icn-btn sh-sm ml-2 mr-2 tooltip",style:{"--tooltip-txt":`'${n("Refresh Groundhogg Tags","bit-integrations")}'`},type:"button",disabled:m,children:"↻"})]}),e.jsx("br",{}),e.jsx("br",{}),a.mainAction==="1"&&e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"mt-4",children:e.jsx("b",{className:"wdt-100",children:n("Actions","bit-integrations")})}),e.jsx("div",{className:"btcd-hr mt-1"}),e.jsx(G,{groundhoggConf:a,setGroundhoggConf:s,formFields:t})]})]})}export{re as G};
