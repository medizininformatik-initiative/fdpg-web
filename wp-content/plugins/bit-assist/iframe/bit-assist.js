!function(){"use strict";const t=window?.bit_assist_?.api?.base||"http://bit-assist-wp.test/wp-json/bit-assist/v1",i=window?.bit_assist_?.api?.base?`${bit_assist_.api.base}/iframe`:"http://localhost:5000",e=new URL(i).origin,s=window?.bit_assist_?.api?.separator||"?",a="http:"===window.location.protocol?"i":"s",o="localhost"===window.location.hostname?window.location.host:window.location.hostname,n=window.location.href,d=document.documentElement.offsetWidth,r=window.innerHeight;let c="100px",l="100px",w=0;const h=`\n#bit-assist-widget-container{--ba-top:auto;--ba-left:auto;--ba-bottom:10;--ba-right:10;position:fixed;z-index:9999999;bottom:0;right:0;width:${l};height:${c};max-width:100%}\n#bit-assist-widget-container.bottom-right{left:var(--ba-left);right:var(--ba-right);top:var(--ba-top);bottom:var(--ba-bottom)}\n#bit-assist-widget-container.bottom-left{left:var(--ba-left);right:var(--ba-right);top:var(--ba-top);bottom:var(--ba-bottom)}\n#bit-assist-widget-container.top-right{left:var(--ba-left);right:var(--ba-right);top:var(--ba-top);bottom:var(--ba-bottom)}\n#bit-assist-widget-container.top-left{left:var(--ba-left);right:var(--ba-right);top:var(--ba-top);bottom:var(--ba-bottom)}\n#bit-assist-widget-iframe{width:100%;height:100%;border:none;}\n.bit-assist-hide{visibility:hidden;pointer-events:none}\n`,b=document.createElement("style");b.appendChild(document.createTextNode(h));const g=document.createElement("div");g.id="bit-assist-widget-container",g.classList.add("bit-assist-hide");const f=document.createElement("iframe");function p(t,i=!1){const e=window.scrollY,s=document.body.offsetHeight,a=window.innerHeight,o=Math.round(e/(s-a)*100);if(!i)return o;!w&&o>=i?(w=1,m(o)):w&&o<i&&(w=0,m(o))}function m(t){f.contentWindow.postMessage({action:"scrollPercent",scrollPercent:t},e)}function u(t,i){l=t+"px",c=i+"px",Object.assign(g.style,{width:l,height:c})}function v(){return"undefined"!=typeof Tawk_API}f.title="wp-bit-assist",f.src=`${i}${s}clientDomain=${a}-protocol-bit-assist-${o}`,f.id="bit-assist-widget-iframe",f.setAttribute("allowfullscreen",""),f.setAttribute("scrolling","no"),g.appendChild(f),document.body.append(b,g),document.addEventListener("click",(t=>{g.classList.contains("bit-assist-open")&&!t.target.closest("#bit-assist-widget-container")&&f.contentWindow.postMessage({action:"clickOutside"},e)})),window.addEventListener("message",(i=>{if(i.origin!==e)return;const{action:s}=i.data;if("getClientInfo"===s){const i=p();f.contentWindow.postMessage({action:"windowLoaded",url:n,winWidth:d,winHeight:r,scrollPercent:i,apiEndPoint:t},e)}else if("widgetLoaded"===s){const{height:t,width:e,position:s,top:a,bottom:o,left:n,right:d,pageScroll:r}=i.data;!function(t,i,e,s,a){t.indexOf("top")>-1&&g.style.setProperty("--ba-top",i+"px");t.indexOf("bottom")>-1&&g.style.setProperty("--ba-bottom",e+"px");t.indexOf("left")>-1&&g.style.setProperty("--ba-left",s+"px");t.indexOf("right")>-1&&g.style.setProperty("--ba-right",a+"px")}(s,a,o,n,d),g.classList.remove("bit-assist-hide"),g.classList.add(s),u(e,t),r>0&&window.addEventListener("scroll",(t=>p(0,r)))}else if("widgetOpen"===s){const{isWidgetOpen:t}=i.data;g.classList.toggle("bit-assist-open",t)}else if("removeWidget"===s)g.remove(),b.remove();else if("resetWidgetSize"===s){const{height:t,width:e}=i.data;u(e,t)}else if("chatWidgetClick"===s){const{chatWidgetName:t}=i.data;!function(t){"tawk"===t&&function(){if(!v())return alert("Sorry, Tawk not loaded yet."),null;try{Tawk_API=Tawk_API||{},Tawk_API.showWidget(),Tawk_API.toggle(),g.classList.add("bit-assist-hide")}catch(t){alert("Sorry, Tawk not loaded yet."),g.classList.remove("bit-assist-hide")}}()}(t)}else if("bitAssistChannelClick"===s){const{channelInfo:t}=i.data;window.dataLayer=window.dataLayer||[],window.dataLayer.push({event:"bitAssistChannel",...t})}})),window.addEventListener("load",(()=>{!function(){if(!v())return!1;Tawk_API=Tawk_API||{},Tawk_API.onLoad=function(){Tawk_API.hideWidget()},Tawk_API.onChatStarted=function(){Tawk_API.showWidget(),g.classList.add("bit-assist-hide")},Tawk_API.onChatMessageAgent=function(){Tawk_API.showWidget(),g.classList.add("bit-assist-hide")},Tawk_API.onChatMessageSystem=function(){Tawk_API.showWidget(),g.classList.add("bit-assist-hide")},Tawk_API.onChatEnded=function(){Tawk_API.hideWidget(),g.classList.remove("bit-assist-hide")},Tawk_API.onChatMinimized=function(){Tawk_API.hideWidget(),g.classList.remove("bit-assist-hide")},Tawk_API.onStatusChange=function(){Tawk_API.hideWidget()}}()}))}();
