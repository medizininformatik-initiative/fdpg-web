var k=Object.defineProperty;var p=Object.getOwnPropertySymbols;var m=Object.prototype.hasOwnProperty,y=Object.prototype.propertyIsEnumerable;var _=(e,t,a)=>t in e?k(e,t,{enumerable:!0,configurable:!0,writable:!0,value:a}):e[t]=a,d=(e,t)=>{for(var a in t||(t={}))m.call(t,a)&&_(e,a,t[a]);if(p)for(var a of p(t))y.call(t,a)&&_(e,a,t[a]);return e};import{_ as c,b as u}from"./bi-490-178.js";const D=(e,t,a,o,f,i,r,s,n)=>{let g=d({},t);if(r){const l=d({},s);l[e.target.name]="",n(d({},l))}switch(g[e.target.name]=e.target.value,e.target.name){case"listId":g=listChange(g,o,a,f,i);break}a(d({},g))},S=(e,t,a,o)=>{a(!0);const f={clientId:e.clientId,clientSecret:e.clientSecret,baseUrl:e.baseUrl,tokenDetails:e.tokenDetails};u(f,"mautic_get_fields").then(i=>{var r,s;if(i&&i.success){const n=d({},e);i.data&&(n.default||(n.default={}),(r=n.default)!=null&&r.fields||(n.default.fields={}),n.default.fields=i.data),(s=i.data)!=null&&s.tokenDetails&&(n.tokenDetails=i.data.tokenDetails),o({show:!0,msg:c("Fields refreshed","bit-integrations")}),t(d({},n))}else o({show:!0,msg:c("Fields refresh failed. please try again","bit-integrations")});a(!1)}).catch(()=>a(!1))},F=(e,t,a,o)=>{a(!0);const f={clientId:e.clientId,clientSecret:e.clientSecret,baseUrl:e.baseUrl,tokenDetails:e.tokenDetails};u(f,"mautic_get_tags").then(i=>{var r,s;if(i&&i.success){const n=d({},e);i.data&&(n.default||(n.default={}),(r=n.default)!=null&&r.tags||(n.default.tags={}),n.default.tags=i.data),(s=i.data)!=null&&s.tokenDetails&&(n.tokenDetails=i.data.tokenDetails),o({show:!0,msg:c("Tags refreshed","bit-integrations")}),t(d({},n))}else o({show:!0,msg:c("Tags refresh failed. please try again","bit-integrations")});a(!1)}).catch(()=>a(!1))},R=e=>{const t={},o=window.location.href.replace(`${window.opener.location.href}`,"").split("&");o&&o.forEach(f=>{const i=f.split("=");i[1]&&(t[i[0]]=i[1])}),localStorage.setItem(`__${e}`,JSON.stringify(t)),window.close()},v=(e,t,a,o,f,i,r)=>{if(!t.clientId||!t.clientSecret||!t.baseUrl){o({clientId:t.clientId?"":c("Client ID cann't be empty","bit-integrations"),clientSecret:t.clientSecret?"":c("Secret key cann't be empty","bit-integrations"),baseUrl:t.baseUrl?"":c("Base Url can't be empty","bit-integrations")});return}i(!0);const s=`${t.baseUrl}/oauth/v2/authorize?client_id=${t.clientId}&redirect_uri=${encodeURIComponent(window.location.href)}&response_type=code`,n=window.open(s,e,"width=400,height=609,toolbar=off"),g=setInterval(()=>{if(n.closed){clearInterval(g);let l={},w=!1;const b=localStorage.getItem(`__${e}`);if(b&&(w=!0,l=JSON.parse(b),localStorage.removeItem(`__${e}`),l.code.search("#"))){const[h]=l.code.split("#");l.code=h}if(!l.code||l.error||!l||!w){const h=l.error?`Cause: ${l.error}`:"";r({show:!0,msg:`${c("Authorization failed","bit-integrations")} ${h}. ${c("please try again","bit-integrations")}`}),i(!1)}else{const h=d({},t);h.accountServer=l["accounts-server"],I(l,h,a,f,i,r)}}},500)},I=(e,t,a,o,f,i)=>{const r=d({},e);r.clientId=t.clientId,r.clientSecret=t.clientSecret,r.baseUrl=t.baseUrl,r.redirectURI=window.location.href,u(r,"mautic_generate_token").then(s=>s).then(s=>{if(s&&s.success){const n=d({},t);n.tokenDetails=s.data,a(n),o(!0),i({show:!0,msg:c("Authorized Successfully","bit-integrations")})}else s&&s.data&&s.data.data||!s.success&&typeof s.data=="string"?i({show:!0,msg:`${c("Authorization failed Cause:","bit-integrations")}${s.data.data||s.data}. ${c("please try again","bit-integrations")}`}):i({show:!0,msg:c("Authorization failed. please try again","bit-integrations")});f(!1)})},A=e=>!((e.field_map?e.field_map.filter(a=>!a.formField&&!a.mauticField):[]).length>0);export{S as a,v as b,A as c,F as g,D as h,R as s};
