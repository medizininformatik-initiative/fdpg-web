var L=Object.defineProperty;var F=Object.getOwnPropertySymbols;var $=Object.prototype.hasOwnProperty,V=Object.prototype.propertyIsEnumerable;var f=(t,l,a)=>l in t?L(t,l,{enumerable:!0,configurable:!0,writable:!0,value:a}):t[l]=a,x=(t,l)=>{for(var a in l||(l={}))$.call(l,a)&&f(t,a,l[a]);if(F)for(var a of F(l))V.call(l,a)&&f(t,a,l[a]);return t};import{r as j,j as e,L as B}from"./main.js";import{a7 as E,_ as n,d as G,a8 as D,h as O,B as W,e as z,c as J,a as S}from"./bi-490-178.js";import{S as U}from"./bi-224-925.js";import{e as K}from"./bi-266-720.js";import{I as Q}from"./bi-811-721.js";import{g as w,r as P,C as X,c as _}from"./bi-195-391.js";import{S as Y}from"./bi-652-725.js";import"./bi-369-724.js";import"./bi-422-718.js";const M=(t,l,a)=>{const i=x({},l);i.field_map.splice(t,0,{}),a(x({},i))},Z=(t,l,a)=>{const i=x({},l);i.field_map.length>1&&i.field_map.splice(t,1),a(x({},i))},A=(t,l,a,i)=>{const c=x({},a);c.field_map[l][t.target.name]=t.target.value,t.target.value==="custom"&&(c.field_map[l].customValue=""),i(x({},c))};function C({companyHubConf:t,setCompanyHubConf:l,loading:a,setLoading:i}){var p,r;const[c,h]=j.useState({show:!1,action:()=>{}}),d=(s,o)=>{var k;const g=x({},t);o==="company"&&((k=s.target)!=null&&k.checked?(g.companies===void 0&&(g.companies=w(t,l,i)),g.actions.company=!0):(h({show:!1}),delete g.actions.company)),h({show:o}),l(x({},g))},u=()=>{h({show:!1})},b=(s,o)=>{l(g=>(g[o]=s,g))};return e.jsxs("div",{className:"pos-rel d-flx flx-wrp",children:[t.actionName==="contact"&&e.jsx(E,{checked:((p=t==null?void 0:t.selectedCompany)==null?void 0:p.length)||!1,onChange:s=>d(s,"company"),className:"wdt-200 mt-4 mr-2",value:"company",title:n("Add Company","bit - integrations"),subTitle:n("Add Company")}),e.jsxs(G,{className:"custom-conf-mdl",mainMdlCls:"o-v",btnClass:"blue",btnTxt:n("Ok","bit-integrations"),show:c.show==="company",close:u,action:u,title:n("company","bit-integrations"),children:[e.jsx("div",{className:"btcd-hr mt-2 mb-2"}),e.jsx("div",{className:"mt-2",children:n("Select Company","bit-integrations")}),a.companies?e.jsx(B,{style:{display:"flex",justifyContent:"center",alignItems:"center",height:45,transform:"scale(0.5)"}}):e.jsxs("div",{className:"flx flx-between mt-2",children:[e.jsx(D,{options:(r=t==null?void 0:t.companies)==null?void 0:r.map(s=>({label:s,value:s})),className:"msl-wrp-options",defaultValue:t.selectedCompany,onChange:s=>b(s,"selectedCompany"),singleSelect:!0}),e.jsx("button",{onClick:()=>w(t,l,i),className:"icn-btn sh-sm ml-2 mr-2 tooltip",style:{"--tooltip-txt":`${n("Refresh Companies","bit-integrations")}'`},type:"button",children:"↻"})]})]})]})}function H({i:t,formFields:l,field:a,companyHubConf:i,setCompanyHubConf:c}){var r;const h=["owner","pipeline","stage","primaryContact","type","tags","lostReason","source","status","priority","currency","isActive","primaryCompany"],d=(i==null?void 0:i.companyHubFields)&&(i==null?void 0:i.companyHubFields.filter(s=>s.required===!0&&!h.includes(s.key)))||[],u=(i==null?void 0:i.companyHubFields)&&(i==null?void 0:i.companyHubFields.filter(s=>s.required===!1&&!h.includes(s.key)))||[],b=O(W),{isPro:p}=b;return e.jsx("div",{className:"flx mt-2 mb-2 btcbi-field-map",children:e.jsxs("div",{className:"pos-rel flx",children:[e.jsxs("div",{className:"flx integ-fld-wrp",children:[e.jsxs("select",{className:"btcd-paper-inp mr-2",name:"formField",value:a.formField||"",onChange:s=>A(s,t,i,c),children:[e.jsx("option",{value:"",children:n("Select Field","bit-integrations")}),e.jsx("optgroup",{label:"Form Fields",children:l==null?void 0:l.map(s=>e.jsx("option",{value:s.name,children:s.label},`ff-rm-${s.name}`))}),e.jsx("option",{value:"custom",children:n("Custom...","bit-integrations")}),e.jsx("optgroup",{label:`General Smart Codes ${p?"":"(PRO)"}`,children:p&&((r=Y)==null?void 0:r.map(s=>e.jsx("option",{value:s.name,children:s.label},`ff-rm-${s.name}`)))})]}),a.formField==="custom"&&e.jsx(CustomField,{field:a,index:t,conf:i,setConf:c,fieldValue:"customValue",fieldLabel:"Custom Value",className:"mr-2"}),e.jsxs("select",{className:"btcd-paper-inp",disabled:t<d.length,name:"companyHubFormField",value:t<d.length?d[t].key||"":a.companyHubFormField||"",onChange:s=>A(s,t,i,c),children:[e.jsx("option",{value:"",children:n("Select Field","bit-integrations")}),t<d.length?e.jsx("option",{value:d[t].key,children:d[t].label},d[t].key):u.map(({key:s,label:o})=>e.jsx("option",{value:s,children:o},s))]})]}),t>=d.length&&e.jsxs(e.Fragment,{children:[e.jsx("button",{onClick:()=>M(t,i,c),className:"icn-btn sh-sm ml-2 mr-1",type:"button",children:"+"}),e.jsx("button",{onClick:()=>Z(t,i,c),className:"icn-btn sh-sm ml-1",type:"button","aria-label":"btn",children:e.jsx("span",{className:"btcd-icn icn-trash-2"})})]})]})})}function ee({formFields:t,companyHubConf:l,setCompanyHubConf:a,loading:i,setLoading:c,isLoading:h,setIsLoading:d,setSnackbar:u}){const b=r=>{const s=x({},l),{name:o}=r.target;r.target.value!==""?(s[o]=r.target.value,P(s,a,d,u)):(delete s[o],delete s.actionId),a(s)},p=(r,s)=>{a(o=>(o[s]=r,o))};return e.jsxs(e.Fragment,{children:[e.jsx("br",{}),e.jsx("b",{className:"wdt-200 d-in-b",children:n("Select Action:","bit-integrations")}),e.jsxs("select",{onChange:b,name:"actionName",value:l.actionName,className:"btcd-paper-inp w-5",children:[e.jsx("option",{value:"",children:n("Select an action","bit-integrations")}),e.jsx("option",{value:"contact","data-action_name":"contact",children:n("Create Contact","bit-integrations")})]}),h&&e.jsx(B,{style:{display:"flex",justifyContent:"center",alignItems:"center",height:100,transform:"scale(0.7)"}}),l.actionName==="contact"&&!h&&e.jsxs(e.Fragment,{children:[e.jsx("br",{}),e.jsx("br",{}),e.jsxs("div",{className:"flx",children:[e.jsx("b",{className:"wdt-200 d-in-b",children:n("Select Role:","bit-integrations")}),e.jsx(D,{options:["Lead","Prospect","Client"].map(r=>({label:r,value:r})),className:"msl-wrp-options dropdown-custom-width",defaultValue:l==null?void 0:l.selectedRole,onChange:r=>p(r,"selectedRole"),singleSelect:!0})]})]}),l.actionName&&!h&&e.jsxs("div",{children:[e.jsx("br",{}),e.jsxs("div",{className:"mt-5",children:[e.jsx("b",{className:"wdt-100",children:n("Field Map","bit-integrations")}),e.jsx("button",{onClick:()=>P(l,a,d,u),className:"icn-btn sh-sm ml-2 mr-2 tooltip",style:{"--tooltip-txt":`'${n("Refresh Fields","bit-integrations")}'`},type:"button",children:"↻"})]}),e.jsx("br",{}),e.jsx("div",{className:"btcd-hr mt-1"}),e.jsxs("div",{className:"flx flx-around mt-2 mb-2 btcbi-field-map-label",children:[e.jsx("div",{className:"txt-dp",children:e.jsx("b",{children:n("Form Fields","bit-integrations")})}),e.jsx("div",{className:"txt-dp",children:e.jsx("b",{children:n("CompanyHub Fields","bit-integrations")})})]}),l==null?void 0:l.field_map.map((r,s)=>e.jsx(H,{i:s,field:r,companyHubConf:l,formFields:t,setCompanyHubConf:a,setSnackbar:u},`rp-m-${s+9}`)),e.jsx("div",{className:"txt-center btcbi-field-map-button mt-2",children:e.jsx("button",{onClick:()=>M(l.field_map.length,l,a),className:"icn-btn sh-sm",type:"button",children:"+"})}),e.jsx("br",{}),e.jsx("br",{}),e.jsx("div",{className:"mt-4",children:e.jsx("b",{className:"wdt-100",children:n("Actions","bit-integrations")})}),e.jsx("div",{className:"btcd-hr mt-1"}),e.jsx(C,{companyHubConf:l,setCompanyHubConf:a,formFields:t,loading:i,setLoading:c})]})]})}function me({formFields:t,setFlow:l,flow:a,allIntegURL:i}){const c=z(),[h,d]=j.useState(!1),[u,b]=j.useState({}),[p,r]=j.useState(1),[s,o]=j.useState({show:!1}),g=[{label:"First Name",key:"FirstName",required:!1},{label:"Last Name",key:"LastName",required:!0},{label:"Email Address",key:"Email",required:!1},{label:"Company",key:"Company",required:!1},{label:"Phone Number",key:"Phone",required:!1},{label:"Job Title",key:"Designation",required:!1},{label:"Description",key:"Description",required:!1},{label:"Source",key:"Source",required:!1},{label:"Next Follow Up Date",key:"NextFollowUpDate",required:!1},{label:"Twitter",key:"Twitter",required:!1},{label:"LinkedIn",key:"LinkedIn",required:!1},{label:"GooglePlus",key:"GooglePlus",required:!1},{label:"Facebook",key:"Facebook",required:!1},{label:"Skype",key:"Skype",required:!1},{label:"Street",key:"Street",required:!1},{label:"City",key:"City",required:!1},{label:"State",key:"State",required:!1},{label:"Country",key:"Country",required:!1},{label:"Postal Code",key:"PostalCode",required:!1},{label:"Postal Code",key:"PostalCode",required:!1}],k=[{label:"Company Name",key:"Name",required:!0},{label:"Website",key:"Website",required:!1},{label:"Phone Number",key:"Phone",required:!1},{label:"Description",key:"Description",required:!1},{label:"Billing Street",key:"BillingStreet",required:!1},{label:"Billing City",key:"BillingCity",required:!1},{label:"Billing State",key:"BillingState",required:!1},{label:"Billing Country",key:"BillingCountry",required:!1},{label:"Billing Postal Code",key:"BillingPostalCode",required:!1},{label:"Shipping Street",key:"ShippingStreet",required:!1},{label:"Shipping City",key:"ShippingCity",required:!1},{label:"Shipping State",key:"ShippingState",required:!1},{label:"Shipping Country",key:"ShippingCountry",required:!1},{label:"Shipping Postal Code",key:"ShippingPostalCode",required:!1}],R=[{label:"Deal Name",key:"Name",required:!0},{label:"Amount",key:"Amount",required:!1},{label:"Close Date",key:"CloseDate",required:!1}],[m,v]=j.useState({name:"CompanyHub",type:"CompanyHub",sub_domain:"",api_key:"",field_map:[{formField:"",companyHubFormField:""}],actionName:"",contactFields:g,companyFields:k,dealFields:R,actions:{}}),I=()=>{d(!0),K(a,l,i,m,c,"","",d).then(N=>{var q;N.success?(S.success((q=N.data)==null?void 0:q.msg),c.push(i)):S.error(N.data||N)})},T=y=>{if(!_(m)){S.error("Please map mandatory fields");return}if(!m.selectedRole){S.error("Please select a Role");return}m.field_map.length>0&&r(y)};return document.querySelector(".btcd-s-wrp").scrollTop=0,e.jsxs("div",{children:[e.jsx(J,{snack:s,setSnackbar:o}),e.jsx("div",{className:"txt-center mt-2",children:e.jsx(U,{step:3,active:p})}),e.jsx(X,{companyHubConf:m,setCompanyHubConf:v,step:p,setStep:r,loading:u,setLoading:b,setSnackbar:o}),e.jsxs("div",{className:"btcd-stp-page",style:x({},p===2&&{width:900,height:"auto",overflow:"visible"}),children:[e.jsx(ee,{formFields:t,companyHubConf:m,setCompanyHubConf:v,loading:u,setLoading:b,isLoading:h,setIsLoading:d,setSnackbar:o}),(m==null?void 0:m.actionName)&&e.jsxs("button",{onClick:()=>T(3),disabled:!_(m),className:"btn f-right btcd-btn-lg green sh-sm flx",type:"button",children:[n("Next","bit-integrations")," "," ",e.jsx("div",{className:"btcd-icn icn-arrow_back rev-icn d-in-b"})]})]}),(m==null?void 0:m.actionName)&&e.jsx(Q,{step:p,saveConfig:()=>I(),isLoading:h,dataConf:m,setDataConf:v,formFields:t})]})}export{me as default};
