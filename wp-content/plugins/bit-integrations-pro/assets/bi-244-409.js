var H=Object.defineProperty;var C=Object.getOwnPropertySymbols;var R=Object.prototype.hasOwnProperty,J=Object.prototype.propertyIsEnumerable;var k=(d,o,c)=>o in d?H(d,o,{enumerable:!0,configurable:!0,writable:!0,value:c}):d[o]=c,x=(d,o)=>{for(var c in o||(o={}))R.call(o,c)&&k(d,c,o[c]);if(C)for(var c of C(o))J.call(o,c)&&k(d,c,o[c]);return d};import{r as p,j as e}from"./main.js";import{e as K,b as w,c as Q,j as a,a7 as V,E as W}from"./bi-490-178.js";import{e as X}from"./bi-266-720.js";import{P as j,a as g,c as Y,b as Z}from"./bi-361-754.js";import{p as ee}from"./bi-666-755.js";import{C as te}from"./bi-369-724.js";import"./bi-422-718.js";import"./bi-652-725.js";import"./bi-528-726.js";function me({formFields:d,setFlow:o,flow:c,allIntegURL:I}){var v,_,N;const[M,L]=p.useState([]),[T,E]=p.useState([]),[$,D]=p.useState([]),[u,O]=p.useState([]),q=K(),[A,f]=p.useState(!1),[s,r]=p.useState({name:"Pods",type:"Pods",post_map:[{post_author:"logged_in_user"}],pod_field_map:[{}],pod_file_map:[{}],condition:{action_behavior:"",actions:[{field:"",action:"value"}],logics:[{field:"",logic:"",val:""},"or",{field:"",logic:"",val:""}]}}),[U,m]=p.useState({show:!1}),h=(t,i,l)=>{const n=x({},s);l?n[t]=Number(i):n[t]=i,r(n)},z=(t,i)=>{const l=x({},s);l[t]=i,w({post_type:i},"pods/fields").then(n=>{var F,y,P,S;n!=null&&n.success&&n!==void 0&&(L(Object.values((F=n==null?void 0:n.data)==null?void 0:F.podFields)),E(Object.values((y=n==null?void 0:n.data)==null?void 0:y.podFiles)),n!=null&&n.data&&(l.pod_field_map=Object.values((P=n==null?void 0:n.data)==null?void 0:P.podFields).filter(b=>b.required).map(b=>({formField:"",podFormField:b.key,required:b.required})),((S=l==null?void 0:l.pod_field_map)==null?void 0:S.length)<1&&(l.pod_field_map=[{}])),r(l))})};p.useEffect(()=>{w({},"pods/list","","GET").then(t=>{const{data:i}=t;O(i==null?void 0:i.post_types),D(i.users)})},[]);const B=(t,i)=>{const l=x({},s);i?l.condition.action_behavior=t:l.condition.action_behavior="",r(l)},G=()=>{if(!s.post_type){m({show:!0,msg:a("Pod cann't be empty","bit-integrations")});return}if(!s.post_status){m({show:!0,msg:a("Post Status cann't be empty","bit-integrations")});return}if(!Y(s)){m({show:!0,msg:a("Please map mandatory fields","bit-integrations")});return}if(!Z(s)){m({show:!0,msg:a("Please map mandatory fields","bit-integrations")});return}f(!0),X(c,o,I,s,q,"","",f)};return e.jsxs("div",{style:{width:900},children:[e.jsx(Q,{snack:U,setSnackbar:m}),e.jsx("div",{className:"mt-3",children:e.jsx("b",{children:a("Integration Name ","bit-integrations")})}),e.jsx("input",{className:"btcd-paper-inp w-5 mt-1",onChange:t=>h(t.target.name,t.target.value),name:"name",value:s.name,type:"text",placeholder:a("Integration Name...","bit-integrations")}),e.jsxs("div",{className:"mt-3",children:[e.jsx("b",{children:a("Pod","bit-integrations")})," ",e.jsx("span",{style:{color:"red"},children:"*"})]}),e.jsxs("select",{name:"post_type",onChange:t=>z(t.target.name,t.target.value),className:"btcd-paper-inp w-5 mt-1",children:[e.jsx("option",{disabled:!0,selected:!0,children:"Select Type"}),u==null?void 0:u.map((t,i)=>e.jsx("option",{value:t.name,children:t.label},`pod-${i*2}`))]}),e.jsxs("div",{className:"mt-3",children:[e.jsx("b",{children:a("Post Status","bit-integrations")})," ",e.jsx("span",{style:{color:"red"},children:"*"})]}),e.jsxs("select",{name:"post_status",onChange:t=>h(t.target.name,t.target.value),className:"btcd-paper-inp w-5 mt-1",children:[e.jsx("option",{disabled:!0,selected:!0,children:a("Select Status","bit-integrations")}),e.jsx("option",{value:"publish",children:"Publish"}),e.jsx("option",{value:"draft",children:"Draft"}),e.jsx("option",{value:"inherit",children:"Inherit"}),e.jsx("option",{value:"auto-draft",children:"Auto-Draft"}),e.jsx("option",{value:"private ",children:"Private"}),e.jsx("option",{value:"pending",children:"Pending"})]}),e.jsx("div",{className:"mt-3",children:e.jsx("b",{children:a("Comment Status","bit-integrations")})}),e.jsxs("select",{name:"comment_status",onChange:t=>h(t.target.name,t.target.value),className:"btcd-paper-inp w-5 mt-1",children:[e.jsx("option",{disabled:!0,selected:!0,children:a("Select Status","bit-integrations")}),e.jsx("option",{value:"open",children:"Open"}),e.jsx("option",{value:"closed",children:"Closed"})]}),e.jsx("div",{className:"mt-3",children:e.jsx("b",{children:a("Author","bit-integrations")})}),e.jsxs("select",{name:"post_author",onChange:t=>h(t.target.name,t.target.value),className:"btcd-paper-inp w-5 mt-1",children:[e.jsx("option",{disabled:!0,selected:!0,children:a("Select Author","bit-integrations")}),e.jsx("option",{value:"logged_in_user",children:"Logged In User"}),$.map((t,i)=>e.jsx("option",{value:t.ID,children:t.display_name},`pod-${i*2}`))]}),e.jsxs("div",{children:[e.jsxs("div",{children:[e.jsx("div",{className:"mt-3 mb-1",children:e.jsx("b",{children:"Post Fields Mapping"})}),e.jsx("div",{className:"btcd-hr"}),e.jsxs("div",{className:"flx flx-around mt-2 mb-2 btcbi-field-map-label",children:[e.jsx("div",{className:"txt-dp",children:e.jsx("b",{children:a("Form Fields","bit-integrations")})}),e.jsx("div",{className:"txt-dp",children:e.jsx("b",{children:a("Post Fields","bit-integrations")})})]})]}),(v=s==null?void 0:s.post_map)==null?void 0:v.map((t,i)=>e.jsx(j,{i,type:"post",field:t,formFields:d,podsConf:s,setPodsConf:r,podFields:ee,fieldType:"fields"},`analytics-m-${i+9}`)),e.jsx("div",{className:"txt-center btcbi-field-map-button mt-2",children:e.jsx("button",{onClick:()=>g("post_map",s.post_map.length,s,r),className:"icn-btn sh-sm",type:"button",children:"+"})}),e.jsxs("div",{children:[e.jsx("div",{className:"mt-3 mb-1",children:e.jsx("b",{children:"Pod Fields Mapping"})}),e.jsx("div",{className:"btcd-hr"}),e.jsxs("div",{className:"flx flx-around mt-2 mb-2 btcbi-field-map-label",children:[e.jsx("div",{className:"txt-dp",children:e.jsx("b",{children:a("Form Fields","bit-integrations")})}),e.jsx("div",{className:"txt-dp",children:e.jsx("b",{children:a("Pod Fields","bit-integrations")})})]})]}),s.pod_field_map.map((t,i)=>e.jsx(j,{i,type:"pod",field:t,formFields:d,podsConf:s,setPodsConf:r,podFields:M,fieldType:"fields"},`analytics-m-${i+9}`)),e.jsx("div",{className:"txt-center btcbi-field-map-button mt-2",children:e.jsx("button",{onClick:()=>g("pod_field_map",s.pod_field_map.length,s,r),className:"icn-btn sh-sm",type:"button",children:"+"})}),e.jsxs("div",{children:[e.jsx("div",{className:"mt-3 mb-1",children:e.jsx("b",{children:"Pod File Upload Mapping"})}),e.jsx("div",{className:"btcd-hr"}),e.jsxs("div",{className:"flx flx-around mt-2 mb-2 btcbi-field-map-label",children:[e.jsx("div",{className:"txt-dp",children:e.jsx("b",{children:a("Form Fields","bit-integrations")})}),e.jsx("div",{className:"txt-dp",children:e.jsx("b",{children:a("Pod Fields","bit-integrations")})})]})]}),s.pod_file_map.map((t,i)=>e.jsx(j,{i,type:"podFile",field:t,formFields:d,podsConf:s,setPodsConf:r,podFields:T,fieldType:"file"},`analytics-m-${i+9}`)),e.jsx("div",{className:"txt-center btcbi-field-map-button mt-2",children:e.jsx("button",{onClick:()=>g("pod_file_map",s.pod_file_map.length,s,r),className:"icn-btn sh-sm",type:"button",children:"+"})})]}),(s==null?void 0:s.condition)&&e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"flx",children:e.jsx(V,{onChange:t=>B(t.target.value,t.target.checked),checked:((_=s==null?void 0:s.condition)==null?void 0:_.action_behavior)==="cond",className:"wdt-200 mt-4 mr-2",value:"cond",title:a("Conditional Logics","bit_integration")})}),e.jsx("br",{}),((N=s==null?void 0:s.condition)==null?void 0:N.action_behavior)==="cond"&&e.jsx(te,{formFields:d,dataConf:s,setDataConf:r})]}),e.jsxs("button",{className:"btn f-left btcd-btn-lg green sh-sm flx",type:"button",onClick:()=>G(),children:[a("Save","bit-integrations")," ",A&&e.jsx(W,{size:20,clr:"#022217",className:"ml-2"})]})]})}export{me as default};
