var L=Object.defineProperty;var N=Object.getOwnPropertySymbols;var D=Object.prototype.hasOwnProperty,O=Object.prototype.propertyIsEnumerable;var b=(l,a,i)=>a in l?L(l,a,{enumerable:!0,configurable:!0,writable:!0,value:i}):l[a]=i,d=(l,a)=>{for(var i in a||(a={}))D.call(a,i)&&b(l,i,a[i]);if(N)for(var i of N(a))O.call(a,i)&&b(l,i,a[i]);return l};import{r as j,j as t}from"./main.js";import{T as R,a as u,P as p}from"./bi-805-737.js";import{B as A}from"./bi-475-763.js";import{_ as s,E as S,a7 as U,ad as V,b as q}from"./bi-490-178.js";import{B as z,C as G}from"./bi-369-724.js";import{P as M,R as Y,B as J}from"./bi-568-764.js";import"./bi-422-718.js";function w({formFields:l,webHooks:a,setWebHooks:i,setStep:C,setSnackbar:h,create:T,isInfo:c}){var f,v;const[y,m]=j.useState(!1),[o,x]=j.useState(1),_=["GET","POST","PUT","PATCH","OPTION","DELETE","TRACE","CONNECT"],g=n=>{const e=d({},a);e[n.target.name]=n.target.value,i(d({},e))},E=n=>{m(!0),q({hookDetails:n},"test_webhook").then(e=>{if(e&&e.success)h({show:!0,msg:`${e.data}`}),m(!1);else if(e&&e.data){const r=typeof e.data=="string"?e.data:"Unknown error";h({show:!0,msg:`${r}. ${s("please try again","bit-integrations")}`}),m(!1)}else h({show:!0,msg:s("Webhook tests failed. please try again","bit-integrations")}),m(!1)})};j.useEffect(()=>{if(a&&!(a!=null&&a.condition)){const n=d({},a);n.condition={action_behavior:"",actions:[{field:"",action:"value"}],logics:[{field:"",logic:"",val:""},"or",{field:"",logic:"",val:""}]},i(n)}},[]);const P=(n,e)=>{const r=d({},a);e?r.condition.action_behavior=n:r.condition.action_behavior="",i(r)},B=()=>{setTimeout(()=>{document.getElementById("btcd-settings-wrp").scrollTop=0},300),C(2)},$='You can test any kind of webhook using <a href="https://webhook.is/" target="_blank" rel="noreferrer">webhook.is</a>';return t.jsxs("div",{style:{width:c&&900},children:[t.jsx("div",{className:"flx ",children:t.jsxs("div",{className:"w-8 mr-2 mt-2 mb-4",children:[t.jsx("div",{className:"f-m",children:s("Integration name","bit-integrations")}),t.jsx("input",{name:"name",onChange:n=>g(n),className:"btcd-paper-inp mt-1",type:"text",value:a.name,disabled:c})]})}),t.jsxs("div",{className:"flx",children:[t.jsxs("div",{className:"w-5 mr-2 ",children:[t.jsx("div",{className:"f-m",children:s("Link:","bit-integrations")}),t.jsx("input",{name:"url",onChange:n=>g(n),className:"btcd-paper-inp mt-1",type:"text",value:a.url,disabled:c})]}),t.jsxs("div",{className:"w-3",children:[t.jsx("div",{className:"f-m",children:s("Method:","bit-integrations")}),t.jsx("select",{name:"method",onChange:n=>g(n),defaultValue:a.method,className:"btcd-paper-inp mt-1",disabled:c,children:_.map((n,e)=>t.jsx("option",{value:n,children:n},`method-${e*2}`))})]})]}),(a==null?void 0:a.apiConsole)&&t.jsxs("small",{className:"d-blk mt-2",children:[s("To got Webhook , Please Visit","bit-integrations")," ",t.jsx("a",{className:"btcd-link",href:a.apiConsole,target:"_blank",rel:"noreferrer",children:s(`${a.type} Dashboard`,"bit-integrations")})]}),!c&&t.jsxs(z,{onClick:()=>E(a),className:"btn btcd-btn-o-blue",children:[s("Test Webhook","bit-integrations"),y&&t.jsx(S,{size:14,clr:"#022217",className:"ml-2"})]}),t.jsx("br",{}),t.jsx("br",{}),t.jsxs(R,{children:[t.jsxs("div",{className:"flx mt-2",children:[t.jsx(u,{children:t.jsx("button",{className:`btcd-s-tab-link ${o===1&&"s-t-l-active"}`,type:"button",children:s("Params","bit-integrations")})}),t.jsx(u,{children:t.jsx("button",{className:`btcd-s-tab-link ${o===2&&"s-t-l-active"}`,type:"button",children:s("Headers","bit-integrations")})}),t.jsx(u,{children:t.jsx("button",{className:`btcd-s-tab-link ${o===3&&"s-t-l-active"}`,type:"button",children:s("Body","bit-integrations")})})]}),t.jsx("div",{className:"btcd-hr"}),t.jsx(p,{children:t.jsx(M,{webHooks:a,setWebHooks:i,formFields:l,isInfo:c,setTab:x})}),t.jsx(p,{children:t.jsx(Y,{webHooks:a,setWebHooks:i,formFields:l,isInfo:c,setTab:x})}),t.jsx(p,{children:t.jsx(J,{webHooks:a,setWebHooks:i,formFields:l,isInfo:c,setTab:x})})]}),(a==null?void 0:a.condition)&&t.jsxs(t.Fragment,{children:[t.jsx("div",{className:"flx",children:t.jsx(U,{onChange:n=>P(n.target.value,n.target.checked),checked:((f=a==null?void 0:a.condition)==null?void 0:f.action_behavior)==="cond",className:"wdt-200 mt-4 mr-2",value:"cond",title:s("Conditional Logics","bit_integration"),isInfo:c})}),t.jsx("br",{}),((v=a==null?void 0:a.condition)==null?void 0:v.action_behavior)==="cond"&&t.jsx(G,{formFields:l,dataConf:a,setDataConf:i})]}),T&&t.jsxs("button",{onClick:()=>B(),className:"btn btcd-btn-lg green sh-sm flx",type:"button",children:[s("Next","bit-integrations"),t.jsx(A,{className:"ml-1 rev-icn"})]}),t.jsx(V,{note:$})]})}export{w as default};
