var B=Object.defineProperty;var T=Object.getOwnPropertySymbols;var D=Object.prototype.hasOwnProperty,G=Object.prototype.propertyIsEnumerable;var M=(a,e,d)=>e in a?B(a,e,{enumerable:!0,configurable:!0,writable:!0,value:d}):a[e]=d,g=(a,e)=>{for(var d in e||(e={}))D.call(e,d)&&M(a,d,e[d]);if(T)for(var d of T(e))G.call(e,d)&&M(a,d,e[d]);return a};import{j as t,r as V,L as A}from"./main.js";import{b as f,a as y,_ as i,h as z,B as J,a7 as S,d as R,a8 as $}from"./bi-490-178.js";import{h as q,a as E,d as K}from"./bi-200-835.js";import{S as Q}from"./bi-652-725.js";import{T as U}from"./bi-528-726.js";import{h as W}from"./bi-266-720.js";const tt=(a,e,d)=>{const l=g({},e),{name:s}=a.target;a.target.value!==""?l[s]=a.target.value:delete l[s],d(g({},l))},X=a=>{const e=a==null?void 0:a.leadFields.filter(d=>d.required===!0);return e.length>0?e.map(d=>({formField:"",propovoiceCrmFormField:d.key})):[{formField:"",propovoiceCrmFormField:""}]},H=(a,e,d,l)=>{l(!0),f(null,"propovoice_crm_lead_tags").then(s=>{if(s&&s.success){e(h=>{const b=g({},h);return b.default||(b.default={}),s.data&&(b.default.allTags=s.data),b}),l(!1),y.success(i("All tags fetched successfully","bit-integrations"));return}l(!1),y.error(i("Propovoice Crm tags fetch failed. please try again","bit-integrations"))}).catch(()=>l(!1))},O=(a,e,d,l)=>{l(!0),f(null,"propovoice_crm_lead_label").then(s=>{if(s&&s.success){e(h=>{const b=g({},h);return b.default||(b.default={}),s.data&&(b.default.allLabels=s.data),b}),l(!1),y.success(i("All label fetched successfully","bit-integrations"));return}l(!1),y.error(i("Propovoice Crm label fetch failed. please try again","bit-integrations"))}).catch(()=>l(!1))};function Y({i:a,field:e,formFields:d,propovoiceCrmConf:l,setPropovoiceCrmConf:s}){var u,x,N,F;if(((u=l==null?void 0:l.field_map)==null?void 0:u.length)===1&&e.propovoiceCrmFormField===""){const n=g({},l),c=X(n);n.field_map=c,s(n)}const h=((x=l==null?void 0:l.leadFields)==null?void 0:x.filter(n=>n.required===!0))||[],b=((N=l==null?void 0:l.leadFields)==null?void 0:N.filter(n=>n.required===!1))||[],r=z(J),{isPro:m}=r;return t.jsx("div",{className:"flx mt-2 mb-2 btcbi-field-map",children:t.jsxs("div",{className:"pos-rel flx",children:[t.jsxs("div",{className:"flx integ-fld-wrp",children:[t.jsxs("select",{className:"btcd-paper-inp mr-2",name:"formField",value:e.formField||"",onChange:n=>q(n,a,l,s),children:[t.jsx("option",{value:"",children:i("Select Field","bit-integrations")}),t.jsx("optgroup",{label:"Form Fields",children:d==null?void 0:d.map(n=>t.jsx("option",{value:n.name,children:n.label},`ff-rm-${n.name}`))}),t.jsx("option",{value:"custom",children:i("Custom...","bit-integrations")}),t.jsx("optgroup",{label:`General Smart Codes ${m?"":"(PRO)"}`,children:m&&((F=Q)==null?void 0:F.map(n=>t.jsx("option",{value:n.name,children:n.label},`ff-rm-${n.name}`)))})]}),e.formField==="custom"&&t.jsx(U,{onChange:n=>W(n,a,l,s),label:i("Custom Value","bit-integrations"),className:"mr-2",type:"text",value:e.customValue,placeholder:i("Custom Value","bit-integrations"),formFields:d}),t.jsxs("select",{className:"btcd-paper-inp",disabled:a<h.length,name:"propovoiceCrmFormField",value:a<h.length?h[a].key||"":e.propovoiceCrmFormField||"",onChange:n=>q(n,a,l,s),children:[t.jsx("option",{value:"",children:i("Select Field","bit-integrations")}),a<h.length?t.jsx("option",{value:h[a].key,children:h[a].label},h[a].key):b.map(({key:n,label:c})=>t.jsx("option",{value:n,children:c},n))]})]}),a>=h.length&&t.jsxs(t.Fragment,{children:[t.jsx("button",{onClick:()=>E(a,l,s),className:"icn-btn sh-sm ml-2 mr-1",type:"button",children:"+"}),t.jsx("button",{onClick:()=>K(a,l,s),className:"icn-btn sh-sm ml-1",type:"button","aria-label":"btn",children:t.jsx("span",{className:"btcd-icn icn-trash-2"})})]})]})})}function Z({propovoiceCrmConf:a,setPropovoiceCrmConf:e,formFields:d,isLoading:l,setIsLoading:s}){var x,N,F,n;const[h,b]=V.useState({show:!1,action:()=>{}}),r=(c,w)=>{var _,k;const j=g({},a);w==="tags"?(_=c.target)!=null&&_.checked?(j.actions.tags=!0,b({show:"tags"})):(b({show:!1}),delete j.actions.tags):w==="label"&&((k=c.target)!=null&&k.checked?(j.actions.label=!0,b({show:"label"})):(b({show:!1}),delete j.actions.label)),e(g({},j))},m=()=>{b({show:!1})},u=(c,w)=>{const j=g({},a);w==="tags"?j.tags=c:w==="label"&&(j.label=c),e(j)};return t.jsxs("div",{className:"pos-rel d-flx w-8",children:[t.jsx(S,{checked:((x=a==null?void 0:a.actions)==null?void 0:x.tags)||!1,onChange:c=>r(c,"tags"),className:"wdt-200 mt-4 mr-2",value:"tags",title:i("Add tags","bit-integrations"),subTitle:i("tags add lead","bit-integrations")}),t.jsx(S,{checked:((N=a==null?void 0:a.actions)==null?void 0:N.label)||!1,onChange:c=>r(c,"label"),className:"wdt-200 mt-4 mr-2",value:"label",title:i("Add label","bit-integrations"),subTitle:i("label add lead","bit-integrations")}),t.jsxs(R,{className:"custom-conf-mdl",mainMdlCls:"o-v",btnClass:"blue",btnTxt:i("Ok","bit-integrations"),show:h.show==="tags",close:m,action:m,title:i("Tags","bit-integrations"),children:[t.jsx("div",{className:"btcd-hr mt-2 mb-2"}),t.jsx("div",{className:"mt-2",children:i("Select tag","bit-integrations")}),l?t.jsx(A,{style:{display:"flex",justifyContent:"center",alignItems:"center",height:45,transform:"scale(0.5)"}}):t.jsxs("div",{className:"flx flx-between mt-2",children:[t.jsx($,{options:(F=a==null?void 0:a.default)!=null&&F.allTags?a.default.allTags.map(c=>({label:c.name,value:c.term_id})):[],className:"msl-wrp-options",defaultValue:a==null?void 0:a.tags,onChange:c=>u(c,"tags")}),t.jsx("button",{onClick:()=>H(a,e,l,s),className:"icn-btn sh-sm ml-2 mr-2 tooltip",style:{"--tooltip-txt":`${i("Refresh Tags","bit-integrations")}'`},type:"button",children:"↻"})]})]}),t.jsxs(R,{className:"custom-conf-mdl",mainMdlCls:"o-v",btnClass:"blue",btnTxt:i("Ok","bit-integrations"),show:h.show==="label",close:m,action:m,title:i("Label","bit-integrations"),children:[t.jsx("div",{className:"btcd-hr mt-2 mb-2"}),t.jsx("div",{className:"mt-2",children:i("Select label","bit-integrations")}),l?t.jsx(A,{style:{display:"flex",justifyContent:"center",alignItems:"center",height:45,transform:"scale(0.5)"}}):t.jsxs("div",{className:"flx flx-between mt-2",children:[t.jsx($,{options:(n=a==null?void 0:a.default)!=null&&n.allLabels?a.default.allLabels.map(c=>({label:c.name,value:c.term_id})):[],singleSelect:!0,className:"msl-wrp-options",defaultValue:a==null?void 0:a.label,onChange:c=>u(c,"label")}),t.jsx("button",{onClick:()=>O(a,e,l,s),className:"icn-btn sh-sm ml-2 mr-2 tooltip",style:{"--tooltip-txt":`${i("Refresh Label","bit-integrations")}'`},type:"button",children:"↻"})]})]})]})}function at({formID:a,formFields:e,handleInput:d,propovoiceCrmConf:l,setPropovoiceCrmConf:s,isLoading:h,setIsLoading:b,setSnackbar:r}){const m=u=>{const x=g({},l),{name:N}=u.target;u.target.value!==""?x[N]=u.target.value:delete x[N],x[u.target.name]=u.target.value,s(g({},x))};return V.useEffect(()=>{(l==null?void 0:l.mainAction)==="1"&&(O(l,s,h,b),H(l,s,h,b))},[(l==null?void 0:l.mainAction)==="1"]),t.jsxs(t.Fragment,{children:[h&&t.jsx(A,{style:{display:"flex",justifyContent:"center",alignItems:"center",height:100,transform:"scale(0.7)"}}),t.jsxs(t.Fragment,{children:[t.jsx("br",{}),t.jsx("b",{className:"wdt-200 d-in-b",children:i("Actions:","bit-integrations")}),t.jsxs("select",{onChange:m,name:"mainAction",value:l==null?void 0:l.mainAction,className:"btcd-paper-inp w-5",children:[t.jsx("option",{value:"",children:i("Select Actions","bit-integrations")}),(l==null?void 0:l.allActions)&&l.allActions.map(({key:u,label:x})=>t.jsx("option",{value:u,children:x},u))]}),t.jsx("br",{}),t.jsx("br",{}),t.jsx("div",{className:"mt-4",children:t.jsx("b",{className:"wdt-100",children:i("Map Fields","bit-integrations")})}),t.jsx("div",{className:"btcd-hr mt-1"}),t.jsxs("div",{className:"flx flx-around mt-2 mb-2 btcbi-field-map-label",children:[t.jsx("div",{className:"txt-dp",children:t.jsx("b",{children:i("Form Fields","bit-integrations")})}),t.jsx("div",{className:"txt-dp",children:t.jsx("b",{children:i("Propovice CRM Fields","bit-integrations")})})]}),l.field_map.map((u,x)=>t.jsx(Y,{i:x,field:u,formFields:e,propovoiceCrmConf:l,setPropovoiceCrmConf:s},`keap-m-${x+9}`)),t.jsx("br",{}),t.jsx("div",{className:"txt-center btcbi-field-map-button mt-2",children:t.jsx("button",{onClick:()=>E(l.field_map.length,l,s),className:"icn-btn sh-sm",type:"button",children:"+"})}),t.jsx("div",{className:"mt-4",children:t.jsx("b",{className:"wdt-100",children:i("Actions","bit-integrations")})}),t.jsx("div",{className:"btcd-hr mt-1"}),t.jsx(Z,{propovoiceCrmConf:l,setPropovoiceCrmConf:s,formFields:e,isLoading:h,setIsLoading:b})]})]})}export{at as P,tt as h};
