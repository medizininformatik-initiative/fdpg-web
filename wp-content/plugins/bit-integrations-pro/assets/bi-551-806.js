var T=Object.defineProperty;var y=Object.getOwnPropertySymbols;var L=Object.prototype.hasOwnProperty,A=Object.prototype.propertyIsEnumerable;var N=(s,t,a)=>t in s?T(s,t,{enumerable:!0,configurable:!0,writable:!0,value:a}):s[t]=a,m=(s,t)=>{for(var a in t||(t={}))L.call(t,a)&&N(s,a,t[a]);if(y)for(var a of y(t))A.call(t,a)&&N(s,a,t[a]);return s};import{r as u,j as e,L as f}from"./main.js";import{a7 as w,_ as c,d as F,a8 as I,h as R,B as V}from"./bi-490-178.js";import{h as $,a as q}from"./bi-266-720.js";import{s as k,g as O}from"./bi-725-807.js";import{S as P}from"./bi-652-725.js";import{T as B}from"./bi-528-726.js";function E({fluentSupportConf:s,setFluentSupportConf:t,formID:a,formFields:i,setSnackbar:n}){var _;const[d,g]=u.useState(!1),[x,o]=u.useState({show:!1}),h=(r,v)=>{const j=m({},s);v==="support_staff"?r!==""?j.actions.support_staff=r:delete j.actions.support_staff:v==="client_priority"&&(r!==""?j.actions.client_priority=r:delete j.actions.client_priority),t(m({},j))},p=[{label:"Normal",value:"normal"},{label:"Critical",value:"critical"},{label:"Medium",value:"medium"}],l=()=>{var r;(r=s.default)!=null&&r.agents||k(a,s,t,g,n),o({show:"support_staff"})},b=()=>{o({show:!1})};return e.jsxs("div",{className:"pos-rel",children:[e.jsxs("div",{className:"d-flx flx-wrp",children:[e.jsxs("div",{style:{display:"flex",flexDirection:"column"},children:[e.jsx(w,{onChange:l,checked:"support_staff"in s.actions,className:"wdt-200 mt-4 mr-2",value:"support_staff",title:c("Support Staff","bit-integrations"),subTitle:c("Add a Support Staff to ticket pushed to fluentSupport.","bit-integrations")}),!s.actions.support_staff&&e.jsx("small",{style:{marginLeft:30,marginTop:10,color:"red"},children:c("Support Staff is required","bit-integrations")})]}),e.jsx(w,{onChange:()=>o({show:"client_priority"}),checked:"client_priority"in s.actions,className:"wdt-200 mt-4 mr-2",value:"client_priority",title:c("Client Priority","bit-integrations"),subTitle:c("Add Client Priority on Ticket in fluentSupport.","bit-integrations")})]}),e.jsxs(F,{className:"custom-conf-mdl",mainMdlCls:"o-v",btnClass:"blue",btnTxt:c("Ok","bit-integrations"),show:x.show==="support_staff",close:b,action:b,title:c("Ticket Owner","bit-integrations"),children:[e.jsx("div",{className:"btcd-hr mt-2"}),d?e.jsx(f,{style:{display:"flex",justifyContent:"center",alignItems:"center",height:45,transform:"scale(0.5)"}}):e.jsxs("div",{className:"flx flx-between mt-2",children:[e.jsxs("select",{value:s.actions.support_staff,className:"btcd-paper-inp",onChange:r=>h(r.target.value,"support_staff"),children:[e.jsx("option",{value:"",children:c("Select Support Staff","bit-integrations")}),((_=s==null?void 0:s.default)==null?void 0:_.agents)&&s.default.agents.map(r=>e.jsx("option",{value:r.id,children:r.full_name},r.id))]}),e.jsx("button",{onClick:()=>k(a,s,t,g,n),className:"icn-btn sh-sm ml-2 mr-2 tooltip",style:{"--tooltip-txt":'"Refresh Support Staff"'},type:"button",disabled:d,children:"â†»"})]})]}),e.jsxs(F,{className:"custom-conf-mdl",mainMdlCls:"o-v",btnClass:"blue",btnTxt:c("Ok","bit-integrations"),show:x.show==="client_priority",close:b,action:b,title:c("Select Priority","bit-integrations"),children:[e.jsx("div",{className:"btcd-hr mt-2"}),e.jsx("div",{className:"mt-2",children:c("Select client priority to ticket.","bit-integrations")}),e.jsx(I,{singleSelect:!0,defaultValue:s.actions.client_priority,className:"mt-2 w-9",onChange:r=>h(r,"client_priority"),options:p})]})]})}const G=(s,t,a)=>{const i=m({},t);i.field_map.splice(s,0,{}),a(m({},i))},H=(s,t,a)=>{const i=m({},t);i.field_map.length>1&&i.field_map.splice(s,1),a(m({},i))},M=(s,t,a,i)=>{const n=m({},a);n.field_map[t][s.target.name]=s.target.value,s.target.value==="custom"&&(n.field_map[t].customValue=""),i(m({},n))};function z({i:s,formFields:t,field:a,fluentSupportConf:i,setFluentSupportConf:n}){var h,p;if(((h=i==null?void 0:i.field_map)==null?void 0:h.length)===1&&a.fluentSupportFormField===""){const l=m({},i),b=O(l);l.field_map=b,n(l)}const d=(i==null?void 0:i.fluentSupportFields.filter(l=>l.required===!0))||[],g=(i==null?void 0:i.fluentSupportFields.filter(l=>l.required===!1))||[],x=R(V),{isPro:o}=x;return e.jsx("div",{className:"flx mt-2 mb-2 btcbi-field-map",children:e.jsxs("div",{className:"pos-rel flx",children:[e.jsxs("div",{className:"flx integ-fld-wrp",children:[e.jsxs("select",{className:"btcd-paper-inp mr-2",name:"formField",value:a.formField||"",onChange:l=>M(l,s,i,n),children:[e.jsx("option",{value:"",children:c("Select Field","bit-integrations")}),e.jsx("optgroup",{label:"Form Fields",children:t==null?void 0:t.map(l=>e.jsx("option",{value:l.name,children:l.label},`ff-rm-${l.name}`))}),e.jsx("option",{value:"custom",children:c("Custom...","bit-integrations")}),e.jsx("optgroup",{label:`General Smart Codes ${o?"":"(PRO)"}`,children:o&&((p=P)==null?void 0:p.map(l=>e.jsx("option",{value:l.name,children:l.label},`ff-rm-${l.name}`)))})]}),a.formField==="custom"&&e.jsx(B,{onChange:l=>$(l,s,i,n),label:c("Custom Value","bit-integrations"),className:"mr-2",type:"text",value:a.customValue,placeholder:c("Custom Value","bit-integrations"),formFields:t}),e.jsxs("select",{className:"btcd-paper-inp",disabled:s<d.length,name:"fluentSupportFormField",value:s<d.length?d[s].key||"":a.fluentSupportFormField||"",onChange:l=>M(l,s,i,n),children:[e.jsx("option",{value:"",children:c("Select Field","bit-integrations")}),s<d.length?e.jsx("option",{value:d[s].key,children:d[s].label},d[s].key):g.map(({key:l,label:b})=>e.jsx("option",{value:l,children:b},l))]})]}),s>=d.length&&e.jsxs(e.Fragment,{children:[e.jsx("button",{onClick:()=>G(s,i,n),className:"icn-btn sh-sm ml-2 mr-1",type:"button",children:"+"}),e.jsx("button",{onClick:()=>H(s,i,n),className:"icn-btn sh-sm ml-1",type:"button","aria-label":"btn",children:e.jsx("span",{className:"btcd-icn icn-trash-2"})})]})]})})}function Y({formID:s,formFields:t,handleInput:a,fluentSupportConf:i,setFluentSupportConf:n,isLoading:d,setIsLoading:g,setSnackbar:x}){return e.jsxs(e.Fragment,{children:[e.jsx("br",{}),e.jsx("br",{}),d&&e.jsx(f,{style:{display:"flex",justifyContent:"center",alignItems:"center",height:100,transform:"scale(0.7)"}}),i.field_map&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"flx flx-around mt-2 mb-2 btcbi-field-map-label",children:[e.jsx("div",{className:"txt-dp",children:e.jsx("b",{children:c("Form Fields","bit-integrations")})}),e.jsx("div",{className:"txt-dp",children:e.jsx("b",{children:c("fluentSupport Fields","bit-integrations")})})]}),i.field_map.map((o,h)=>e.jsx(z,{i:h,field:o,fluentSupportConf:i,formFields:t,setFluentSupportConf:n},`desk-m-${h+9}`)),e.jsx("div",{className:"txt-center btcbi-field-map-button mt-2",children:e.jsx("button",{onClick:()=>q(i.field_map.length,i,n),className:"icn-btn sh-sm",type:"button",children:"+"})}),e.jsx("br",{}),e.jsx("br",{}),e.jsx("div",{className:"mt-4",children:e.jsx("b",{className:"wdt-100",children:c("Actions","bit-integrations")})}),e.jsx("div",{className:"btcd-hr mt-1"}),e.jsx(E,{fluentSupportConf:i,setFluentSupportConf:n,formID:s,formFields:t,setSnackbar:x})]})]})}export{Y as F};
